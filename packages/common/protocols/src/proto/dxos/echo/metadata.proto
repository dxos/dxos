//
// Copyright 2021 DXOS.org
//

syntax = "proto3";

package dxos.echo.metadata;

import "google/protobuf/timestamp.proto";
import "../halo/keys.proto";

message EchoMetadata {
  /**
   * Version number that is inceremnted every time there's a breaking change to the storage schema.
   * 
   * This is used to detect if the storage schema has changed since the last time the client was run.
   * Loading data from a different version will might result in an error.
   */
  int32 version = 1;

  repeated PartyMetadata parties = 2;

  google.protobuf.Timestamp created = 3;
  google.protobuf.Timestamp updated = 4;
}

message PartyMetadata {
  /// Party key.
  PubKey key = 1;

  /// List of all feed associated with the party.
  repeated PubKey feedKeys = 2;

  /// Key of the wriatable data feed.
  PubKey dataFeedKey = 3;

  /// Key of the wriatable control feed.
  PubKey controlFeedKey = 4;

  // Latest timeframe reached while processing party messages.
  TimeframeVector latestTimeframe = 5;
}