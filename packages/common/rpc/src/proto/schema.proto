//
// Copyright 2020 DXOS.org
//

syntax = "proto3";

package dxos.rpc;

message RpcMessage {
  oneof content {
    Request request = 1;
    Response response = 2;

    // Means that the node is open to receiving requests.
    bool open = 3;

    StreamClose streamClose = 4;
  }
}

message Request {
  int32 id = 1;
  string method = 2;
  bytes payload = 3;
  bool stream = 4;
}

message Response {
  int32 id = 1;
  oneof content {
    bytes payload = 2;
    Error error = 3;
    // Sent when stream is closed without an error.
    bool close = 4;
  }
}

// Sent by client to end the streaming response.
message StreamClose {
  int32 id = 1;
}


message Error {
  string name = 1;
  string message = 2;
  string stack = 3;
}
