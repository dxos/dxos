#
# Pages Functions configuration.
# https://developers.cloudflare.com/pages/functions/wrangler-configuration
#
# To tail production logs:
# wrangler pages deployment tail --project-name composer
#

name = "composer-app"
compatibility_date = "2024-04-05"
pages_build_output_dir = "./out/composer"

vars = { ENVIRONMENT = "dev" }

d1_databases = [
  { binding = "DB", database_name = "dev-users", database_id = "756b796d-02e5-45e7-9067-12144a2124b2" }
]

#
# https://preview.composer.space
# NOTE: Previews have restricted access.
# https://developers.cloudflare.com/pages/configuration/preview-deployments/#customize-preview-deployments-access
# Trigger build via (expect approx. 10m).
# curl -X POST https://api.cloudflare.com/client/v4/pages/webhooks/deploy_hooks/bdcb157c-79a8-4b39-aeb3-440bc2aa0741
#

[env.preview]

vars = { ENVIRONMENT = "staging" }

d1_databases = [
  { binding = "DB", database_name = "prod-users", database_id = "f48ca977-f25f-49d2-a203-5fc0cca01f55" }
]

#
# https://composer.space
#

[env.production]

vars = { ENVIRONMENT = "production" }

d1_databases = [
  { binding = "DB", database_name = "prod-users", database_id = "f48ca977-f25f-49d2-a203-5fc0cca01f55" }
]
