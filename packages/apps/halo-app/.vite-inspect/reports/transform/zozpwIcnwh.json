{"resolvedId":"/home/jdw/Code/dxos/dxos/packages/apps/patterns/react-appkit/dist/lib/browser/index.mjs","transforms":[{"name":"vite:load-fallback","result":"var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// packages/apps/patterns/react-appkit/src/components/AppLayout/AppLayout.tsx\nimport React2, { useCallback } from \"react\";\nimport { generatePath, Outlet, useLocation as useLocation2, useNavigate, useParams } from \"react-router-dom\";\nimport { useClient as useClient2, useIdentity, useSpace, useStatus } from \"@dxos/react-client\";\nimport { Menubar } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/hooks/useSafeSpaceKey.ts\nimport { useEffect, useState } from \"react\";\nimport { PublicKey } from \"@dxos/keys\";\nimport { log } from \"@dxos/log\";\nvar useSafeSpaceKey = (hex, onFailure) => {\n  const [spaceKey, setSpaceKey] = useState();\n  useEffect(() => {\n    if (hex) {\n      try {\n        setSpaceKey(PublicKey.fromHex(hex));\n      } catch (e) {\n        log.warn(\"invalid space key\", {\n          hex\n        }, {\n          file: \"/home/jdw/Code/dxos/dxos/packages/apps/patterns/react-appkit/src/hooks/useSafeSpaceKey.ts\",\n          line: 23,\n          scope: void 0,\n          callSite: (f, a) => f(...a)\n        });\n        onFailure == null ? void 0 : onFailure();\n      }\n    } else {\n      setSpaceKey(void 0);\n    }\n  }, [\n    hex\n  ]);\n  return spaceKey;\n};\n\n// packages/apps/patterns/react-appkit/src/hooks/useTelemetry.ts\nimport { useEffect as useEffect2, useMemo } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { useAsyncEffect } from \"@dxos/react-async\";\nimport { useClient } from \"@dxos/react-client\";\nimport * as Sentry from \"@dxos/sentry\";\nimport * as Telemetry2 from \"@dxos/telemetry\";\n\n// packages/apps/patterns/react-appkit/src/telemetry/base-properties.ts\nimport { captureException } from \"@dxos/sentry\";\nimport { humanize } from \"@dxos/util\";\nvar IPDATA_API_KEY = process.env.IPDATA_API_KEY;\nvar DX_TELEMETRY = localStorage.getItem(\"halo-app:telemetry-disabled\");\nvar DX_GROUP = localStorage.getItem(\"halo-app:telemetry-group\");\nvar DX_ENVIRONMENT = process.env.DX_ENVIRONMENT;\nvar DX_RELEASE = process.env.DX_RELEASE;\nvar BASE_TELEMETRY_PROPERTIES = {\n  environment: DX_ENVIRONMENT,\n  release: DX_RELEASE,\n  group: DX_GROUP\n};\nvar _a;\nif ((_a = navigator.storage) == null ? void 0 : _a.estimate) {\n  setInterval(async () => {\n    const storageEstimate = await navigator.storage.estimate();\n    BASE_TELEMETRY_PROPERTIES.storageUsage = storageEstimate.usage;\n    BASE_TELEMETRY_PROPERTIES.storageQuota = storageEstimate.quota;\n  }, 1e4);\n}\nvoid fetch(`https://api.ipdata.co?api-key=${IPDATA_API_KEY}`).then((res) => res.json()).then((data) => {\n  BASE_TELEMETRY_PROPERTIES.city = data.city;\n  BASE_TELEMETRY_PROPERTIES.region = data.region;\n  BASE_TELEMETRY_PROPERTIES.country = data.country;\n  BASE_TELEMETRY_PROPERTIES.latitude = data.latitude;\n  BASE_TELEMETRY_PROPERTIES.longitude = data.longitude;\n}).catch((err) => captureException(err));\nvar getTelemetryIdentifier = (client) => {\n  const profile = client.halo.profile;\n  if (profile) {\n    humanize(profile.identityKey);\n  }\n  return void 0;\n};\n\n// packages/apps/patterns/react-appkit/src/telemetry/listeners.ts\nimport * as Telemetry from \"@dxos/telemetry\";\nvar lastFocusEvent = new Date();\nvar totalTime = 0;\nvar setupTelemetryListeners = (namespace, client) => {\n  const clickCallback = (event3) => {\n    if (DX_GROUP === \"dxos\" && event3.target && !event3.target.id) {\n      console.warn(\"Click event on element without id:\", event3.target);\n    }\n    setTimeout(() => {\n      var _a2, _b;\n      return Telemetry.event({\n        identityId: getTelemetryIdentifier(client),\n        name: `${namespace}.window.click`,\n        properties: {\n          ...BASE_TELEMETRY_PROPERTIES,\n          href: window.location.href,\n          id: (_a2 = event3.target) == null ? void 0 : _a2.id,\n          path: (_b = event3.path) == null ? void 0 : _b.filter((el) => Boolean(el.tagName)).map((el) => `${el.tagName.toLowerCase()}${el.id ? `#${el.id}` : \"\"}`).reverse().join(\">\")\n        }\n      });\n    });\n  };\n  const focusCallback = () => {\n    const now = new Date();\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.window.focus`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeAway: now.getTime() - lastFocusEvent.getTime()\n      }\n    }));\n    lastFocusEvent = now;\n  };\n  const blurCallback = () => {\n    const now = new Date();\n    const timeSpent = now.getTime() - lastFocusEvent.getTime();\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.window.blur`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeSpent\n      }\n    }));\n    lastFocusEvent = now;\n    totalTime = totalTime + timeSpent;\n  };\n  const unloadCallback = () => {\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.page.unload`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeSpent: totalTime\n      }\n    }));\n  };\n  window.addEventListener(\"click\", clickCallback, true);\n  window.addEventListener(\"focus\", focusCallback);\n  window.addEventListener(\"blur\", blurCallback);\n  window.addEventListener(\"beforeunload\", unloadCallback);\n  return () => {\n    window.removeEventListener(\"click\", clickCallback, true);\n    window.removeEventListener(\"focus\", focusCallback);\n    window.removeEventListener(\"blur\", blurCallback);\n    window.removeEventListener(\"beforeunload\", unloadCallback);\n  };\n};\n\n// packages/apps/patterns/react-appkit/src/hooks/useTelemetry.ts\nvar SENTRY_DESTINATION = process.env.SENTRY_DESTINATION;\nvar TELEMETRY_API_KEY = process.env.TELEMETRY_API_KEY;\nvar useTelemetry = ({ namespace, router = true }) => {\n  const location2 = router ? useLocation() : null;\n  const client = useClient();\n  const telemetryDisabled = useMemo(() => DX_TELEMETRY === \"true\", []);\n  useEffect2(() => {\n    if (SENTRY_DESTINATION && !telemetryDisabled) {\n      Sentry.init({\n        destination: SENTRY_DESTINATION,\n        environment: DX_ENVIRONMENT,\n        release: DX_RELEASE,\n        sampleRate: 1\n      });\n    }\n    Telemetry2.init({\n      apiKey: TELEMETRY_API_KEY,\n      enable: Boolean(TELEMETRY_API_KEY) && !telemetryDisabled\n    });\n    Telemetry2.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.page.load`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        loadDuration: window.performance.timing.loadEventEnd - window.performance.timing.loadEventStart\n      }\n    });\n    return setupTelemetryListeners(namespace, client);\n  }, []);\n  useAsyncEffect(async () => {\n    Telemetry2.page({\n      identityId: getTelemetryIdentifier(client),\n      properties: BASE_TELEMETRY_PROPERTIES\n    });\n  }, [\n    location2\n  ]);\n};\n\n// packages/apps/patterns/react-appkit/src/components/StatusIndicator/StatusIndicator.tsx\nimport React from \"react\";\nimport { Tooltip, useTranslation, valenceColorText, mx } from \"@dxos/react-uikit\";\nvar StatusIndicator = ({ status }) => {\n  const { t } = useTranslation();\n  return /* @__PURE__ */ React.createElement(\"div\", {\n    role: \"none\",\n    className: mx(\"fixed bottom-4 right-4\", valenceColorText(\"success\"))\n  }, status && /* @__PURE__ */ React.createElement(\"span\", {\n    className: \"flex h-3 w-3\"\n  }, /* @__PURE__ */ React.createElement(\"span\", {\n    className: \"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-600 opacity-75\"\n  }), /* @__PURE__ */ React.createElement(\"span\", {\n    className: \"relative inline-flex rounded-full h-3 w-3 bg-green-700\"\n  })), !status && /* @__PURE__ */ React.createElement(Tooltip, {\n    content: t(\"heartbeat stalled\")\n  }, /* @__PURE__ */ React.createElement(\"span\", {\n    className: \"flex h-3 w-3\"\n  }, /* @__PURE__ */ React.createElement(\"span\", {\n    className: \"relative inline-flex rounded-full h-3 w-3 bg-red-500\"\n  }))));\n};\n\n// packages/apps/patterns/react-appkit/src/components/AppLayout/AppLayout.tsx\nfunction _extends() {\n  _extends = Object.assign || function(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nvar StatusContainer = () => {\n  const status = useStatus();\n  return /* @__PURE__ */ React2.createElement(StatusIndicator, {\n    status\n  });\n};\nvar AppLayout = ({ spacesPath = \"/spaces\", spacePath = \"/spaces/:space\", manageSpacePath = \"/spaces/:space/settings\", manageProfilePath, suppressSpaceMenu, menubarContent }) => {\n  const client = useClient2();\n  const identity = useIdentity();\n  const { space: spaceHex } = useParams();\n  const spaceKey = useSafeSpaceKey(spaceHex, () => navigate(spacesPath));\n  const space = useSpace(spaceKey);\n  const navigate = useNavigate();\n  const location2 = useLocation2();\n  const pathSegments = location2.pathname.split(\"/\").length;\n  const isManagingSpace = !!spaceHex && pathSegments > 3;\n  const handleManageProfile = useCallback(() => {\n    if (manageProfilePath) {\n      navigate(manageProfilePath);\n    } else {\n      const remoteSource = new URL(client.config.get(\"runtime.client.remoteSource\") || \"https://halo.dxos.org\");\n      const tab = window.open(remoteSource.origin, \"_blank\");\n      tab == null ? void 0 : tab.focus();\n    }\n  }, [\n    client,\n    navigate,\n    manageProfilePath\n  ]);\n  const handleGoToSpace = useCallback(() => navigate(generatePath(spacePath, {\n    space: spaceHex\n  })), [\n    navigate,\n    spaceHex\n  ]);\n  const handleManageSpace = useCallback(() => navigate(generatePath(manageSpacePath, {\n    space: spaceHex\n  })), [\n    navigate,\n    spaceHex\n  ]);\n  const handleGoToSpaces = useCallback(() => navigate(spacesPath), [\n    navigate\n  ]);\n  return /* @__PURE__ */ React2.createElement(React2.Fragment, null, /* @__PURE__ */ React2.createElement(Menubar, _extends({\n    profile: identity,\n    space\n  }, isManagingSpace && {\n    onClickGoToSpace: handleGoToSpace\n  }, space && {\n    onClickGoToSpaces: handleGoToSpaces\n  }, !suppressSpaceMenu && {\n    onClickManageSpace: handleManageSpace\n  }, {\n    onClickManageProfile: handleManageProfile\n  }), menubarContent), /* @__PURE__ */ React2.createElement(StatusContainer, null), /* @__PURE__ */ React2.createElement(\"main\", {\n    className: \"max-is-5xl mli-auto pli-7 pbs-16\"\n  }, /* @__PURE__ */ React2.createElement(Outlet, {\n    context: {\n      space\n    }\n  })));\n};\n\n// packages/apps/patterns/react-appkit/src/components/ErrorProvider/ErrorProvider.tsx\nimport { Warning } from \"phosphor-react\";\nimport React3, { createContext, useCallback as useCallback2, useContext, useEffect as useEffect3, useState as useState2 } from \"react\";\nimport { Tooltip as Tooltip2, valenceColorText as valenceColorText2, defaultFocus, useTranslation as useTranslation2, mx as mx2 } from \"@dxos/react-uikit\";\nimport { captureException as captureException2 } from \"@dxos/sentry\";\nvar ErrorContext = /* @__PURE__ */ createContext({\n  errors: [],\n  addError: () => {\n  },\n  resetErrors: () => {\n  }\n});\nvar logError = (f, ...args) => console.error(f, ...args);\nvar ErrorProvider = ({ children }) => {\n  const { t } = useTranslation2();\n  const [errors, setErrors] = useState2([]);\n  const addError = useCallback2((error) => setErrors([\n    error,\n    ...errors\n  ]), []);\n  const resetErrors = useCallback2(() => setErrors([]), []);\n  const onUnhandledRejection = useCallback2((event3) => {\n    captureException2(event3.reason);\n    logError(\"unhandledrejection\", event3.reason);\n    addError(event3.reason);\n    event3.preventDefault();\n  }, []);\n  const onWindowError = useCallback2((message, source, lineno, colno, error) => {\n    captureException2(error);\n    logError(\"onerror\", message);\n    addError(error);\n    return true;\n  }, []);\n  useEffect3(() => {\n    window.onerror = onWindowError;\n    window.addEventListener(\"unhandledrejection\", onUnhandledRejection);\n    return () => {\n      window.onerror = null;\n      window.removeEventListener(\"unhandledrejection\", onUnhandledRejection);\n    };\n  }, []);\n  return /* @__PURE__ */ React3.createElement(ErrorContext.Provider, {\n    value: {\n      errors,\n      addError,\n      resetErrors\n    }\n  }, children, /* @__PURE__ */ React3.createElement(\"div\", {\n    role: \"none\",\n    className: mx2(\"fixed bottom-4 right-4\", valenceColorText2(\"warning\"))\n  }, !!errors.length && /* @__PURE__ */ React3.createElement(Tooltip2, {\n    content: t(\"caught error message\")\n  }, /* @__PURE__ */ React3.createElement(Warning, {\n    tabIndex: 0,\n    weight: \"duotone\",\n    className: mx2(\"w-6 h-6 rounded-md\", defaultFocus)\n  }))));\n};\nvar useErrors = () => useContext(ErrorContext);\n\n// packages/apps/patterns/react-appkit/src/components/Fallback/Fallback.tsx\nimport React4 from \"react\";\nimport { Heading, Loading, useTranslation as useTranslation3 } from \"@dxos/react-uikit\";\nvar Fallback = ({ message }) => /* @__PURE__ */ React4.createElement(\"div\", {\n  className: \"py-8 flex flex-col gap-4\",\n  \"aria-live\": \"polite\"\n}, /* @__PURE__ */ React4.createElement(Loading, {\n  label: message,\n  size: \"lg\"\n}), /* @__PURE__ */ React4.createElement(Heading, {\n  level: 1,\n  className: \"text-lg font-light text-center\"\n}, message));\nvar GenericFallback = () => {\n  const { t } = useTranslation3(\"uikit\");\n  return /* @__PURE__ */ React4.createElement(Fallback, {\n    message: t(\"generic loading label\")\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/FatalError/FatalError.tsx\nimport { Clipboard } from \"phosphor-react\";\nimport React5, { useCallback as useCallback3 } from \"react\";\nimport { Alert, Button, Dialog, Tooltip as Tooltip3, useTranslation as useTranslation4 } from \"@dxos/react-uikit\";\nvar FatalError = ({ error }) => {\n  const { t } = useTranslation4();\n  const isDev = true;\n  const message = String(error);\n  let stack = String(error == null ? void 0 : error.stack);\n  if (stack.indexOf(message) === 0) {\n    stack = stack.substr(message.length).trim();\n  }\n  stack = stack.split(\"\\n\").map((text) => text.trim()).join(\"\\n\");\n  const onCopyError = useCallback3(() => {\n    void navigator.clipboard.writeText(JSON.stringify({\n      message,\n      stack\n    }));\n  }, [\n    message,\n    stack\n  ]);\n  return /* @__PURE__ */ React5.createElement(Dialog, {\n    title: t(\"fatal error label\"),\n    initiallyOpen: true\n  }, isDev ? /* @__PURE__ */ React5.createElement(Alert, {\n    title: message,\n    valence: \"error\",\n    slots: {\n      root: {\n        className: \"mlb-4\"\n      }\n    }\n  }, /* @__PURE__ */ React5.createElement(\"pre\", {\n    className: \"text-xs overflow-auto max-w-72 max-h-72\"\n  }, stack)) : /* @__PURE__ */ React5.createElement(\"p\", null, t(\"fatal error message\")), /* @__PURE__ */ React5.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex\"\n  }, /* @__PURE__ */ React5.createElement(Tooltip3, {\n    content: t(\"copy error label\"),\n    zIndex: \"z-[21]\"\n  }, /* @__PURE__ */ React5.createElement(Button, {\n    onClick: onCopyError\n  }, /* @__PURE__ */ React5.createElement(Clipboard, {\n    weight: \"duotone\",\n    size: \"1em\"\n  }))), /* @__PURE__ */ React5.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex-grow\"\n  }), /* @__PURE__ */ React5.createElement(Button, {\n    variant: \"primary\",\n    onClick: () => location.reload()\n  }, t(\"reload page label\"))));\n};\n\n// packages/apps/patterns/react-appkit/src/components/HeadingWithActions/HeadingWithActions.tsx\nimport React6 from \"react\";\nimport { Heading as Heading2, mx as mx3 } from \"@dxos/react-uikit\";\nfunction _extends2() {\n  _extends2 = Object.assign || function(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends2.apply(this, arguments);\n}\nvar HeadingWithActions = ({ heading, actions, compact, spacer, ...divProps }) => {\n  return /* @__PURE__ */ React6.createElement(\"div\", _extends2({\n    role: \"none\"\n  }, divProps, {\n    className: mx3(\"flex flex-wrap items-center\", compact ? \"gap-2\" : \"gap-x-2 gap-y-4\", divProps.className)\n  }), /* @__PURE__ */ React6.createElement(Heading2, _extends2({}, heading)), typeof spacer === \"undefined\" ? /* @__PURE__ */ React6.createElement(\"div\", {\n    role: \"none\",\n    className: \"grow-[99] min-w-[2rem]\"\n  }) : spacer, /* @__PURE__ */ React6.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex grow gap-2 items-center\"\n  }, actions));\n};\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/InvitationList.tsx\nimport React8 from \"react\";\nimport { defaultDisabled, Group, useTranslation as useTranslation6, mx as mx5 } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/PendingInvitation.tsx\nimport { ProhibitInset, XCircle } from \"phosphor-react\";\nimport React7, { useCallback as useCallback4 } from \"react\";\nimport { Invitation } from \"@dxos/client\";\nimport { useInvitationStatus } from \"@dxos/react-client\";\nimport { Avatar, Button as Button2, CompactQrCode, defaultGroup, getSize, Loading as Loading2, Tooltip as Tooltip4, InvitationStatus, useTranslation as useTranslation5, mx as mx4 } from \"@dxos/react-uikit\";\nfunction _extends3() {\n  _extends3 = Object.assign || function(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends3.apply(this, arguments);\n}\nvar PendingInvitationSkeleton = ({ message }) => {\n  return /* @__PURE__ */ React7.createElement(Loading2, {\n    label: message\n  });\n};\nvar PendingInvitation = ({ wrapper, createInvitationUrl, onClickRemove }) => {\n  const { t } = useTranslation5(\"uikit\");\n  const { cancel, status, haltedAt, authenticationCode, invitationCode } = useInvitationStatus(wrapper);\n  const handleRemove = useCallback4(() => {\n    var _a2;\n    const id = (_a2 = wrapper.invitation) == null ? void 0 : _a2.invitationId;\n    id && onClickRemove(id);\n  }, []);\n  return /* @__PURE__ */ React7.createElement(\"div\", {\n    role: \"group\",\n    className: mx4(defaultGroup({\n      elevation: 1\n    }), \"mbe-2\")\n  }, wrapper.invitation ? /* @__PURE__ */ React7.createElement(React7.Fragment, null, /* @__PURE__ */ React7.createElement(HeadingWithActions, {\n    compact: true,\n    spacer: null,\n    heading: {\n      level: 2,\n      className: \"text-lg font-body flex gap-2 items-center grow-[99] pie-2\",\n      children: /* @__PURE__ */ React7.createElement(Avatar, {\n        size: 10,\n        fallbackValue: wrapper.invitation.invitationId,\n        label: /* @__PURE__ */ React7.createElement(InvitationStatus, _extends3({}, {\n          status,\n          haltedAt\n        }, {\n          className: \"grow\"\n        }))\n      })\n    },\n    actions: /* @__PURE__ */ React7.createElement(React7.Fragment, null, status === Invitation.State.AUTHENTICATING ? /* @__PURE__ */ React7.createElement(\"p\", {\n      className: \"text-xl text-center text-success-500 dark:text-success-300\"\n    }, authenticationCode) : /* @__PURE__ */ React7.createElement(CompactQrCode, _extends3({}, {\n      copyLabel: t(\"copy space invite code short label\", {\n        ns: \"uikit\"\n      }),\n      displayQrLabel: t(\"display space invite qr code label\", {\n        ns: \"uikit\"\n      }),\n      value: createInvitationUrl(invitationCode)\n    })), status === Invitation.State.CANCELLED || status === Invitation.State.ERROR || status === Invitation.State.TIMEOUT || status === Invitation.State.SUCCESS ? /* @__PURE__ */ React7.createElement(React7.Fragment, null, /* @__PURE__ */ React7.createElement(Tooltip4, {\n      content: t(\"remove label\"),\n      tooltipLabelsTrigger: true\n    }, /* @__PURE__ */ React7.createElement(Button2, {\n      className: \"flex md:hidden gap-1 items-center\",\n      onClick: handleRemove\n    }, /* @__PURE__ */ React7.createElement(XCircle, {\n      className: getSize(5)\n    }))), /* @__PURE__ */ React7.createElement(Button2, {\n      className: \"hidden md:flex gap-1 items-center\",\n      onClick: handleRemove\n    }, /* @__PURE__ */ React7.createElement(XCircle, {\n      className: getSize(5)\n    }), /* @__PURE__ */ React7.createElement(\"span\", null, t(\"remove label\")))) : /* @__PURE__ */ React7.createElement(React7.Fragment, null, /* @__PURE__ */ React7.createElement(Tooltip4, {\n      content: t(\"cancel label\"),\n      tooltipLabelsTrigger: true\n    }, /* @__PURE__ */ React7.createElement(Button2, {\n      className: \"flex md:hidden gap-1 items-center\",\n      onClick: cancel\n    }, /* @__PURE__ */ React7.createElement(ProhibitInset, {\n      className: getSize(5)\n    }))), /* @__PURE__ */ React7.createElement(Button2, {\n      className: \"hidden md:flex gap-1 items-center\",\n      onClick: cancel\n    }, /* @__PURE__ */ React7.createElement(ProhibitInset, {\n      className: getSize(5)\n    }), /* @__PURE__ */ React7.createElement(\"span\", null, t(\"cancel label\")))))\n  })) : /* @__PURE__ */ React7.createElement(PendingInvitationSkeleton, {\n    message: t(\"generic loading label\")\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/InvitationList.tsx\nvar InvitationList = ({ createInvitationUrl, invitations, onClickRemove }) => {\n  const { t } = useTranslation6(\"appkit\");\n  const empty = !invitations || invitations.length < 1;\n  return /* @__PURE__ */ React8.createElement(Group, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: !empty ? t(\"invitations label\") : t(\"empty invitations message\"),\n      className: mx5(\"text-xl\", empty && defaultDisabled)\n    },\n    elevation: 0\n  }, !empty && invitations.map((wrapper, index) => {\n    var _a2, _b;\n    return /* @__PURE__ */ React8.createElement(PendingInvitation, {\n      key: (_b = (_a2 = wrapper.invitation) == null ? void 0 : _a2.invitationId) != null ? _b : index,\n      wrapper,\n      createInvitationUrl,\n      onClickRemove\n    });\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/ManageSpacePage/ManageSpacePage.tsx\nimport { UserPlus } from \"phosphor-react\";\nimport React10, { useCallback as useCallback5, useMemo as useMemo2 } from \"react\";\nimport { useNavigate as useNavigate2, useParams as useParams2 } from \"react-router-dom\";\nimport urlJoin from \"url-join\";\nimport { useMembers, useSpace as useSpace2, useSpaceInvitations } from \"@dxos/react-client\";\nimport { Button as Button3, getSize as getSize2, useTranslation as useTranslation8 } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/components/ProfileList/ProfileList.tsx\nimport React9 from \"react\";\nimport { useIdentity as useIdentity2 } from \"@dxos/react-client\";\nimport { useTranslation as useTranslation7, Tag, Avatar as Avatar2, defaultDisabled as defaultDisabled2, defaultGroup as defaultGroup2, Group as Group2, mx as mx6 } from \"@dxos/react-uikit\";\nimport { humanize as humanize2 } from \"@dxos/util\";\nvar ProfileList = ({ profiles }) => {\n  const { t } = useTranslation7(\"appkit\");\n  const identity = useIdentity2();\n  const identityHex = identity == null ? void 0 : identity.identityKey.toHex();\n  return profiles.length > 0 ? /* @__PURE__ */ React9.createElement(\"ul\", {\n    className: \"flex flex-col gap-2 mlb-4\"\n  }, profiles.map((profile) => {\n    var _a2;\n    const profileHex = profile.identityKey.toHex();\n    return /* @__PURE__ */ React9.createElement(\"li\", {\n      key: profileHex,\n      className: mx6(defaultGroup2({\n        elevation: 1,\n        spacing: \"p-1\",\n        rounding: \"rounded\"\n      }), \"flex gap-2 items-center\")\n    }, /* @__PURE__ */ React9.createElement(Avatar2, {\n      variant: \"circle\",\n      fallbackValue: profileHex,\n      label: /* @__PURE__ */ React9.createElement(\"p\", null, (_a2 = profile.displayName) != null ? _a2 : humanize2(profileHex), profileHex === identityHex && /* @__PURE__ */ React9.createElement(Tag, {\n        valence: \"info\",\n        className: \"mli-2 align-middle\"\n      }, t(\"current identity label\")))\n    }));\n  })) : /* @__PURE__ */ React9.createElement(Group2, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: t(\"empty members message\"),\n      className: mx6(\"text-xl\", defaultDisabled2)\n    },\n    elevation: 0\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/ManageSpacePage/ManageSpacePage.tsx\nvar defaultCreateInvitationUrl = (invitationCode) => {\n  const { origin, pathname } = window.location;\n  return urlJoin(origin, pathname, `/#?invitation=${invitationCode}`);\n};\nvar ManageSpacePage = ({ createInvitationUrl = defaultCreateInvitationUrl, spacesPath = \"/\" }) => {\n  const { t } = useTranslation8(\"appkit\");\n  const navigate = useNavigate2();\n  const { space: spaceHex } = useParams2();\n  const spaceKey = useSafeSpaceKey(spaceHex, () => navigate(spacesPath));\n  const space = useSpace2(spaceKey);\n  const members = useMembers(spaceKey);\n  const memberProfiles = useMemo2(() => members.map(({ profile }) => profile).filter((profile) => !!profile), [\n    members\n  ]);\n  const invitations = useSpaceInvitations(space == null ? void 0 : space.key);\n  const handleCreateInvitation = useCallback5(() => {\n    if (space) {\n      space.createInvitation();\n    }\n  }, [\n    space\n  ]);\n  const handleRemove = useCallback5((id) => space == null ? void 0 : space.removeInvitation(id), [\n    space\n  ]);\n  return /* @__PURE__ */ React10.createElement(\"main\", {\n    className: \"max-is-5xl mli-auto pli-7\"\n  }, /* @__PURE__ */ React10.createElement(HeadingWithActions, {\n    heading: {\n      level: 2,\n      children: t(\"space members label\", {\n        ns: \"uikit\"\n      })\n    },\n    actions: /* @__PURE__ */ React10.createElement(React10.Fragment, null, /* @__PURE__ */ React10.createElement(Button3, {\n      variant: \"primary\",\n      onClick: handleCreateInvitation,\n      className: \"flex gap-1 items-center\",\n      disabled: !space\n    }, /* @__PURE__ */ React10.createElement(\"span\", null, t(\"create invitation label\")), /* @__PURE__ */ React10.createElement(UserPlus, {\n      className: getSize2(5)\n    })))\n  }), /* @__PURE__ */ React10.createElement(ProfileList, {\n    profiles: memberProfiles\n  }), /* @__PURE__ */ React10.createElement(InvitationList, {\n    invitations,\n    createInvitationUrl,\n    onClickRemove: handleRemove\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/RequireIdentity/RequireIdentity.tsx\nimport React11, { useEffect as useEffect4 } from \"react\";\nimport { Outlet as Outlet2 } from \"react-router-dom\";\nimport { useIdentity as useIdentity3 } from \"@dxos/react-client\";\nvar RequireIdentity = ({ redirect: to }) => {\n  const identity = useIdentity3();\n  useEffect4(() => {\n    if (!identity) {\n      const redirect = `#?redirect=${encodeURIComponent(window.location.href)}`;\n      window.location.replace(`${to}${redirect}`);\n    }\n  }, []);\n  if (!identity) {\n    return null;\n  }\n  return /* @__PURE__ */ React11.createElement(Outlet2, null);\n};\n\n// packages/apps/patterns/react-appkit/src/components/ServiceWorkerToast/ServiceWorkerToast.tsx\nimport { Gift } from \"phosphor-react\";\nimport React12 from \"react\";\nimport { useTranslation as useTranslation9, Toast, Button as Button4, getSize as getSize3, mx as mx7, useTranslationsContext } from \"@dxos/react-uikit\";\nfunction _extends4() {\n  _extends4 = Object.assign || function(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends4.apply(this, arguments);\n}\nvar isNeedRefreshToast = (props) => props.variant === \"needRefresh\";\nvar ServiceWorkerToast = (props) => {\n  const { t } = useTranslation9(\"appkit\");\n  const { appNs } = useTranslationsContext();\n  const { variant } = props;\n  return /* @__PURE__ */ React12.createElement(Toast, _extends4({\n    initiallyOpen: true,\n    title: variant === \"needRefresh\" ? /* @__PURE__ */ React12.createElement(React12.Fragment, null, /* @__PURE__ */ React12.createElement(Gift, {\n      className: mx7(getSize3(5), \"inline mr-1\"),\n      weight: \"duotone\"\n    }), /* @__PURE__ */ React12.createElement(\"span\", null, t(\"need refresh label\"))) : t(\"offline ready label\", {\n      appName: t(\"current app name\", {\n        ns: appNs\n      })\n    })\n  }, isNeedRefreshToast(props) && {\n    duration: 24e4,\n    description: t(\"need refresh description\"),\n    actionTriggers: [\n      {\n        altText: t(\"refresh alt\"),\n        trigger: /* @__PURE__ */ React12.createElement(Button4, {\n          variant: \"primary\",\n          onClick: () => props.updateServiceWorker()\n        }, t(\"refresh label\"))\n      }\n    ]\n  }, variant === \"offlineReady\" && {\n    closeTrigger: /* @__PURE__ */ React12.createElement(Button4, null, t(\"confirm label\", {\n      ns: \"uikit\"\n    }))\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/SpaceList/SpaceList.tsx\nimport React13 from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Avatar as Avatar3, defaultGroup as defaultGroup3, defaultHover, defaultFocus as defaultFocus2, useTranslation as useTranslation10, defaultDisabled as defaultDisabled3, Group as Group3, Heading as Heading3, mx as mx8 } from \"@dxos/react-uikit\";\nimport { humanize as humanize3 } from \"@dxos/util\";\nvar SpaceList = ({ spaces = [] }) => {\n  const { t } = useTranslation10(\"appkit\");\n  return spaces.length ? /* @__PURE__ */ React13.createElement(React13.Fragment, null, spaces.map((space) => {\n    var _a2;\n    const keyHex = space.key.toHex();\n    const title = (_a2 = space.properties.get(\"title\")) != null ? _a2 : humanize3(keyHex);\n    return /* @__PURE__ */ React13.createElement(Link, {\n      to: `/spaces/${keyHex}`,\n      role: \"group\",\n      key: keyHex,\n      className: mx8(defaultGroup3({\n        elevation: 1,\n        rounding: \"rounded\",\n        spacing: \"p-2\"\n      }), \"flex items-stretch gap-2 mbe-2\", defaultHover({}), defaultFocus2)\n    }, /* @__PURE__ */ React13.createElement(Heading3, {\n      level: 2,\n      className: \"grow flex items-center mbe-0\"\n    }, /* @__PURE__ */ React13.createElement(Avatar3, {\n      size: 12,\n      fallbackValue: keyHex,\n      label: /* @__PURE__ */ React13.createElement(\"p\", {\n        className: \"text-lg grow\"\n      }, title),\n      slots: {\n        root: {\n          className: \"flex gap-1 items-center pr-2 rounded\"\n        }\n      }\n    })));\n  })) : /* @__PURE__ */ React13.createElement(Group3, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: t(\"empty spaces label\"),\n      className: mx8(\"text-xl\", defaultDisabled3)\n    },\n    elevation: 0\n  }, /* @__PURE__ */ React13.createElement(\"p\", {\n    className: defaultDisabled3\n  }, t(\"empty spaces message\")));\n};\n\n// packages/apps/patterns/react-appkit/src/components/SpacesPage/SpacesPage.tsx\nimport { Plus, Rocket } from \"phosphor-react\";\nimport React14, { useCallback as useCallback6 } from \"react\";\nimport { generatePath as generatePath2, useNavigate as useNavigate3, useSearchParams } from \"react-router-dom\";\nimport { useClient as useClient3, useSpaces } from \"@dxos/react-client\";\nimport { Button as Button5, getSize as getSize4, JoinDialog, useTranslation as useTranslation11 } from \"@dxos/react-uikit\";\nvar invitationCodeFromUrl = (text) => {\n  try {\n    const searchParams = new URLSearchParams(text.substring(text.lastIndexOf(\"?\")));\n    const invitation = searchParams.get(\"invitation\");\n    return invitation != null ? invitation : text;\n  } catch (err) {\n    console.error(err);\n    return text;\n  }\n};\nvar SpacesPage = ({ onSpaceCreate, spacePath = \"/spaces/:space\" }) => {\n  const { t } = useTranslation11(\"appkit\");\n  const client = useClient3();\n  const spaces = useSpaces();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate3();\n  const invitationParam = searchParams.get(\"invitation\");\n  const acceptInvitation = useCallback6((invitation) => client.echo.acceptInvitation(invitation), [\n    client\n  ]);\n  const handleCreateSpace = useCallback6(async () => {\n    const space = await client.echo.createSpace();\n    await (onSpaceCreate == null ? void 0 : onSpaceCreate(space));\n  }, [\n    client\n  ]);\n  const handleJoin = useCallback6(({ spaceKey }) => navigate(generatePath2(spacePath, {\n    space: spaceKey.toHex()\n  })), [\n    spacePath\n  ]);\n  return /* @__PURE__ */ React14.createElement(React14.Fragment, null, /* @__PURE__ */ React14.createElement(HeadingWithActions, {\n    className: \"flex-auto text-center mbe-4\",\n    actions: /* @__PURE__ */ React14.createElement(React14.Fragment, null, /* @__PURE__ */ React14.createElement(JoinDialog, {\n      initialInvitationCode: invitationParam != null ? invitationParam : void 0,\n      parseInvitation: (invitationCode) => invitationCodeFromUrl(invitationCode),\n      onJoin: handleJoin,\n      acceptInvitation,\n      dialogProps: {\n        initiallyOpen: Boolean(invitationParam),\n        openTrigger: /* @__PURE__ */ React14.createElement(Button5, {\n          className: \"grow flex gap-1\"\n        }, /* @__PURE__ */ React14.createElement(Rocket, {\n          className: getSize4(5)\n        }), t(\"join space label\", {\n          ns: \"uikit\"\n        }))\n      }\n    }), /* @__PURE__ */ React14.createElement(Button5, {\n      variant: \"primary\",\n      onClick: handleCreateSpace,\n      className: \"grow flex gap-1\"\n    }, /* @__PURE__ */ React14.createElement(Plus, {\n      className: getSize4(5)\n    }), t(\"create space label\", {\n      ns: \"uikit\"\n    }))),\n    heading: {\n      children: t(\"spaces label\")\n    }\n  }), /* @__PURE__ */ React14.createElement(SpaceList, {\n    spaces\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/translations/en-US.ts\nvar en_US_exports = {};\n__export(en_US_exports, {\n  appkit: () => appkit\n});\nvar appkit = {\n  \"list title label\": \"List title\",\n  \"list title placeholder\": \"Untitled list\",\n  \"list description label\": \"List description\",\n  \"list description placeholder\": \"Add an optional description\",\n  \"list item title label\": \"List item title\",\n  \"list item title placeholder\": \"Type here\",\n  \"list item description label\": \"List item description\",\n  \"list item description placeholder\": \"Add an optional description\",\n  \"move list item up label\": \"Move list item up\",\n  \"move list item down label\": \"Move list item down\",\n  \"delete list item label\": \"Remove list item\",\n  \"add list item label\": \"Add list item\",\n  \"need refresh label\": \"Refresh now to get app updates\",\n  \"need refresh description\": \"You\\u2019ll need these updates to continue without interruption.\",\n  \"refresh label\": \"Refresh\",\n  \"refresh alt\": \"Click your browser\\u2019s refresh button or use the refresh keyboard shortcut.\",\n  \"offline ready label\": \"{appName} is ready to use offline.\",\n  \"spaces label\": \"Spaces\",\n  \"empty invitations message\": \"No pending invitations\",\n  \"invitations label\": \"Invitations\",\n  \"create invitation label\": \"Invite\",\n  \"current identity label\": \"You\",\n  \"empty members message\": \"No members in this space\",\n  \"composer placeholder\": \"Write something\\u2026\",\n  \"heartbeat stalled\": \"Heartbeat stalled\",\n  \"empty spaces label\": \"No spaces here\",\n  \"empty spaces message\": \"Why not try creating or joining one?\"\n};\n\n// packages/apps/patterns/react-appkit/src/translations/index.ts\nvar translations = {\n  \"en-US\": en_US_exports\n};\nexport {\n  AppLayout,\n  BASE_TELEMETRY_PROPERTIES,\n  DX_ENVIRONMENT,\n  DX_GROUP,\n  DX_RELEASE,\n  DX_TELEMETRY,\n  ErrorContext,\n  ErrorProvider,\n  Fallback,\n  FatalError,\n  GenericFallback,\n  HeadingWithActions,\n  InvitationList,\n  ManageSpacePage,\n  ProfileList,\n  RequireIdentity,\n  ServiceWorkerToast,\n  SpaceList,\n  SpacesPage,\n  StatusIndicator,\n  getTelemetryIdentifier,\n  setupTelemetryListeners,\n  translations,\n  useErrors,\n  useSafeSpaceKey,\n  useTelemetry\n};\n//# sourceMappingURL=index.mjs.map\n","start":1670465438383,"end":1670465438693},{"name":"vite:react-babel","result":"var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all) __defProp(target, name, {\n    get: all[name],\n    enumerable: true\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/AppLayout/AppLayout.tsx\nimport React2, { useCallback } from \"react\";\nimport { generatePath, Outlet, useLocation as useLocation2, useNavigate, useParams } from \"react-router-dom\";\nimport { useClient as useClient2, useIdentity, useSpace, useStatus } from \"@dxos/react-client\";\nimport { Menubar } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/hooks/useSafeSpaceKey.ts\nimport { useEffect, useState } from \"react\";\nimport { PublicKey } from \"@dxos/keys\";\nimport { log } from \"@dxos/log\";\nvar useSafeSpaceKey = (hex, onFailure) => {\n  const [spaceKey, setSpaceKey] = useState();\n  useEffect(() => {\n    if (hex) {\n      try {\n        setSpaceKey(PublicKey.fromHex(hex));\n      } catch (e) {\n        log.warn(\"invalid space key\", {\n          hex\n        }, {\n          file: \"/home/jdw/Code/dxos/dxos/packages/apps/patterns/react-appkit/src/hooks/useSafeSpaceKey.ts\",\n          line: 23,\n          scope: void 0,\n          callSite: (f, a) => f(...a)\n        });\n        onFailure == null ? void 0 : onFailure();\n      }\n    } else {\n      setSpaceKey(void 0);\n    }\n  }, [hex]);\n  return spaceKey;\n};\n\n// packages/apps/patterns/react-appkit/src/hooks/useTelemetry.ts\nimport { useEffect as useEffect2, useMemo } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { useAsyncEffect } from \"@dxos/react-async\";\nimport { useClient } from \"@dxos/react-client\";\nimport * as Sentry from \"@dxos/sentry\";\nimport * as Telemetry2 from \"@dxos/telemetry\";\n\n// packages/apps/patterns/react-appkit/src/telemetry/base-properties.ts\nimport { captureException } from \"@dxos/sentry\";\nimport { humanize } from \"@dxos/util\";\nvar IPDATA_API_KEY = process.env.IPDATA_API_KEY;\nvar DX_TELEMETRY = localStorage.getItem(\"halo-app:telemetry-disabled\");\nvar DX_GROUP = localStorage.getItem(\"halo-app:telemetry-group\");\nvar DX_ENVIRONMENT = process.env.DX_ENVIRONMENT;\nvar DX_RELEASE = process.env.DX_RELEASE;\nvar BASE_TELEMETRY_PROPERTIES = {\n  environment: DX_ENVIRONMENT,\n  release: DX_RELEASE,\n  group: DX_GROUP\n};\nvar _a;\nif ((_a = navigator.storage) == null ? void 0 : _a.estimate) {\n  setInterval(async () => {\n    const storageEstimate = await navigator.storage.estimate();\n    BASE_TELEMETRY_PROPERTIES.storageUsage = storageEstimate.usage;\n    BASE_TELEMETRY_PROPERTIES.storageQuota = storageEstimate.quota;\n  }, 1e4);\n}\nvoid fetch(`https://api.ipdata.co?api-key=${IPDATA_API_KEY}`).then(res => res.json()).then(data => {\n  BASE_TELEMETRY_PROPERTIES.city = data.city;\n  BASE_TELEMETRY_PROPERTIES.region = data.region;\n  BASE_TELEMETRY_PROPERTIES.country = data.country;\n  BASE_TELEMETRY_PROPERTIES.latitude = data.latitude;\n  BASE_TELEMETRY_PROPERTIES.longitude = data.longitude;\n}).catch(err => captureException(err));\nvar getTelemetryIdentifier = client => {\n  const profile = client.halo.profile;\n  if (profile) {\n    humanize(profile.identityKey);\n  }\n  return void 0;\n};\n\n// packages/apps/patterns/react-appkit/src/telemetry/listeners.ts\nimport * as Telemetry from \"@dxos/telemetry\";\nvar lastFocusEvent = new Date();\nvar totalTime = 0;\nvar setupTelemetryListeners = (namespace, client) => {\n  const clickCallback = event3 => {\n    if (DX_GROUP === \"dxos\" && event3.target && !event3.target.id) {\n      console.warn(\"Click event on element without id:\", event3.target);\n    }\n    setTimeout(() => {\n      var _a2, _b;\n      return Telemetry.event({\n        identityId: getTelemetryIdentifier(client),\n        name: `${namespace}.window.click`,\n        properties: {\n          ...BASE_TELEMETRY_PROPERTIES,\n          href: window.location.href,\n          id: (_a2 = event3.target) == null ? void 0 : _a2.id,\n          path: (_b = event3.path) == null ? void 0 : _b.filter(el => Boolean(el.tagName)).map(el => `${el.tagName.toLowerCase()}${el.id ? `#${el.id}` : \"\"}`).reverse().join(\">\")\n        }\n      });\n    });\n  };\n  const focusCallback = () => {\n    const now = new Date();\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.window.focus`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeAway: now.getTime() - lastFocusEvent.getTime()\n      }\n    }));\n    lastFocusEvent = now;\n  };\n  const blurCallback = () => {\n    const now = new Date();\n    const timeSpent = now.getTime() - lastFocusEvent.getTime();\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.window.blur`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeSpent\n      }\n    }));\n    lastFocusEvent = now;\n    totalTime = totalTime + timeSpent;\n  };\n  const unloadCallback = () => {\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.page.unload`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeSpent: totalTime\n      }\n    }));\n  };\n  window.addEventListener(\"click\", clickCallback, true);\n  window.addEventListener(\"focus\", focusCallback);\n  window.addEventListener(\"blur\", blurCallback);\n  window.addEventListener(\"beforeunload\", unloadCallback);\n  return () => {\n    window.removeEventListener(\"click\", clickCallback, true);\n    window.removeEventListener(\"focus\", focusCallback);\n    window.removeEventListener(\"blur\", blurCallback);\n    window.removeEventListener(\"beforeunload\", unloadCallback);\n  };\n};\n\n// packages/apps/patterns/react-appkit/src/hooks/useTelemetry.ts\nvar SENTRY_DESTINATION = process.env.SENTRY_DESTINATION;\nvar TELEMETRY_API_KEY = process.env.TELEMETRY_API_KEY;\nvar useTelemetry = ({\n  namespace,\n  router = true\n}) => {\n  const location2 = router ? useLocation() : null;\n  const client = useClient();\n  const telemetryDisabled = useMemo(() => DX_TELEMETRY === \"true\", []);\n  useEffect2(() => {\n    if (SENTRY_DESTINATION && !telemetryDisabled) {\n      Sentry.init({\n        destination: SENTRY_DESTINATION,\n        environment: DX_ENVIRONMENT,\n        release: DX_RELEASE,\n        sampleRate: 1\n      });\n    }\n    Telemetry2.init({\n      apiKey: TELEMETRY_API_KEY,\n      enable: Boolean(TELEMETRY_API_KEY) && !telemetryDisabled\n    });\n    Telemetry2.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.page.load`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        loadDuration: window.performance.timing.loadEventEnd - window.performance.timing.loadEventStart\n      }\n    });\n    return setupTelemetryListeners(namespace, client);\n  }, []);\n  useAsyncEffect(async () => {\n    Telemetry2.page({\n      identityId: getTelemetryIdentifier(client),\n      properties: BASE_TELEMETRY_PROPERTIES\n    });\n  }, [location2]);\n};\n\n// packages/apps/patterns/react-appkit/src/components/StatusIndicator/StatusIndicator.tsx\nimport React from \"react\";\nimport { Tooltip, useTranslation, valenceColorText, mx } from \"@dxos/react-uikit\";\nvar StatusIndicator = ({\n  status\n}) => {\n  const {\n    t\n  } = useTranslation();\n  return /* @__PURE__ */React.createElement(\"div\", {\n    role: \"none\",\n    className: mx(\"fixed bottom-4 right-4\", valenceColorText(\"success\"))\n  }, status && /* @__PURE__ */React.createElement(\"span\", {\n    className: \"flex h-3 w-3\"\n  }, /* @__PURE__ */React.createElement(\"span\", {\n    className: \"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-600 opacity-75\"\n  }), /* @__PURE__ */React.createElement(\"span\", {\n    className: \"relative inline-flex rounded-full h-3 w-3 bg-green-700\"\n  })), !status && /* @__PURE__ */React.createElement(Tooltip, {\n    content: t(\"heartbeat stalled\")\n  }, /* @__PURE__ */React.createElement(\"span\", {\n    className: \"flex h-3 w-3\"\n  }, /* @__PURE__ */React.createElement(\"span\", {\n    className: \"relative inline-flex rounded-full h-3 w-3 bg-red-500\"\n  }))));\n};\n\n// packages/apps/patterns/react-appkit/src/components/AppLayout/AppLayout.tsx\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nvar StatusContainer = () => {\n  const status = useStatus();\n  return (\n    /*#__PURE__*/\n    /* @__PURE__ */\n    _jsx(StatusIndicator, {\n      status: status\n    })\n  );\n};\nvar AppLayout = ({\n  spacesPath = \"/spaces\",\n  spacePath = \"/spaces/:space\",\n  manageSpacePath = \"/spaces/:space/settings\",\n  manageProfilePath,\n  suppressSpaceMenu,\n  menubarContent\n}) => {\n  const client = useClient2();\n  const identity = useIdentity();\n  const {\n    space: spaceHex\n  } = useParams();\n  const spaceKey = useSafeSpaceKey(spaceHex, () => navigate(spacesPath));\n  const space = useSpace(spaceKey);\n  const navigate = useNavigate();\n  const location2 = useLocation2();\n  const pathSegments = location2.pathname.split(\"/\").length;\n  const isManagingSpace = !!spaceHex && pathSegments > 3;\n  const handleManageProfile = useCallback(() => {\n    if (manageProfilePath) {\n      navigate(manageProfilePath);\n    } else {\n      const remoteSource = new URL(client.config.get(\"runtime.client.remoteSource\") || \"https://halo.dxos.org\");\n      const tab = window.open(remoteSource.origin, \"_blank\");\n      tab == null ? void 0 : tab.focus();\n    }\n  }, [client, navigate, manageProfilePath]);\n  const handleGoToSpace = useCallback(() => navigate(generatePath(spacePath, {\n    space: spaceHex\n  })), [navigate, spaceHex]);\n  const handleManageSpace = useCallback(() => navigate(generatePath(manageSpacePath, {\n    space: spaceHex\n  })), [navigate, spaceHex]);\n  const handleGoToSpaces = useCallback(() => navigate(spacesPath), [navigate]);\n  return (\n    /*#__PURE__*/\n    /* @__PURE__ */\n    _jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsx(Menubar, {\n        profile: identity,\n        space: space,\n        ...(isManagingSpace && {\n          onClickGoToSpace: handleGoToSpace\n        }),\n        ...(space && {\n          onClickGoToSpaces: handleGoToSpaces\n        }),\n        ...(!suppressSpaceMenu && {\n          onClickManageSpace: handleManageSpace\n        }),\n        onClickManageProfile: handleManageProfile,\n        children: menubarContent\n      }), /*#__PURE__*/_jsx(StatusContainer, {}), /*#__PURE__*/_jsx(\"main\", {\n        className: \"max-is-5xl mli-auto pli-7 pbs-16\",\n        children: /*#__PURE__*/_jsx(Outlet, {\n          context: {\n            space\n          }\n        })\n      })]\n    })\n  );\n};\n\n// packages/apps/patterns/react-appkit/src/components/ErrorProvider/ErrorProvider.tsx\nimport { Warning } from \"phosphor-react\";\nimport React3, { createContext, useCallback as useCallback2, useContext, useEffect as useEffect3, useState as useState2 } from \"react\";\nimport { Tooltip as Tooltip2, valenceColorText as valenceColorText2, defaultFocus, useTranslation as useTranslation2, mx as mx2 } from \"@dxos/react-uikit\";\nimport { captureException as captureException2 } from \"@dxos/sentry\";\nvar ErrorContext = /* @__PURE__ */createContext({\n  errors: [],\n  addError: () => {},\n  resetErrors: () => {}\n});\nvar logError = (f, ...args) => console.error(f, ...args);\nvar ErrorProvider = ({\n  children\n}) => {\n  const {\n    t\n  } = useTranslation2();\n  const [errors, setErrors] = useState2([]);\n  const addError = useCallback2(error => setErrors([error, ...errors]), []);\n  const resetErrors = useCallback2(() => setErrors([]), []);\n  const onUnhandledRejection = useCallback2(event3 => {\n    captureException2(event3.reason);\n    logError(\"unhandledrejection\", event3.reason);\n    addError(event3.reason);\n    event3.preventDefault();\n  }, []);\n  const onWindowError = useCallback2((message, source, lineno, colno, error) => {\n    captureException2(error);\n    logError(\"onerror\", message);\n    addError(error);\n    return true;\n  }, []);\n  useEffect3(() => {\n    window.onerror = onWindowError;\n    window.addEventListener(\"unhandledrejection\", onUnhandledRejection);\n    return () => {\n      window.onerror = null;\n      window.removeEventListener(\"unhandledrejection\", onUnhandledRejection);\n    };\n  }, []);\n  return /* @__PURE__ */React3.createElement(ErrorContext.Provider, {\n    value: {\n      errors,\n      addError,\n      resetErrors\n    }\n  }, children, /* @__PURE__ */React3.createElement(\"div\", {\n    role: \"none\",\n    className: mx2(\"fixed bottom-4 right-4\", valenceColorText2(\"warning\"))\n  }, !!errors.length && /* @__PURE__ */React3.createElement(Tooltip2, {\n    content: t(\"caught error message\")\n  }, /* @__PURE__ */React3.createElement(Warning, {\n    tabIndex: 0,\n    weight: \"duotone\",\n    className: mx2(\"w-6 h-6 rounded-md\", defaultFocus)\n  }))));\n};\nvar useErrors = () => useContext(ErrorContext);\n\n// packages/apps/patterns/react-appkit/src/components/Fallback/Fallback.tsx\nimport React4 from \"react\";\nimport { Heading, Loading, useTranslation as useTranslation3 } from \"@dxos/react-uikit\";\nvar Fallback = ({\n  message\n}) => /* @__PURE__ */React4.createElement(\"div\", {\n  className: \"py-8 flex flex-col gap-4\",\n  \"aria-live\": \"polite\"\n}, /* @__PURE__ */React4.createElement(Loading, {\n  label: message,\n  size: \"lg\"\n}), /* @__PURE__ */React4.createElement(Heading, {\n  level: 1,\n  className: \"text-lg font-light text-center\"\n}, message));\nvar GenericFallback = () => {\n  const {\n    t\n  } = useTranslation3(\"uikit\");\n  return /* @__PURE__ */React4.createElement(Fallback, {\n    message: t(\"generic loading label\")\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/FatalError/FatalError.tsx\nimport { Clipboard } from \"phosphor-react\";\nimport React5, { useCallback as useCallback3 } from \"react\";\nimport { Alert, Button, Dialog, Tooltip as Tooltip3, useTranslation as useTranslation4 } from \"@dxos/react-uikit\";\nvar FatalError = ({\n  error\n}) => {\n  const {\n    t\n  } = useTranslation4();\n  const isDev = true;\n  const message = String(error);\n  let stack = String(error == null ? void 0 : error.stack);\n  if (stack.indexOf(message) === 0) {\n    stack = stack.substr(message.length).trim();\n  }\n  stack = stack.split(\"\\n\").map(text => text.trim()).join(\"\\n\");\n  const onCopyError = useCallback3(() => {\n    void navigator.clipboard.writeText(JSON.stringify({\n      message,\n      stack\n    }));\n  }, [message, stack]);\n  return /* @__PURE__ */React5.createElement(Dialog, {\n    title: t(\"fatal error label\"),\n    initiallyOpen: true\n  }, isDev ? /* @__PURE__ */React5.createElement(Alert, {\n    title: message,\n    valence: \"error\",\n    slots: {\n      root: {\n        className: \"mlb-4\"\n      }\n    }\n  }, /* @__PURE__ */React5.createElement(\"pre\", {\n    className: \"text-xs overflow-auto max-w-72 max-h-72\"\n  }, stack)) : /* @__PURE__ */React5.createElement(\"p\", null, t(\"fatal error message\")), /* @__PURE__ */React5.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex\"\n  }, /* @__PURE__ */React5.createElement(Tooltip3, {\n    content: t(\"copy error label\"),\n    zIndex: \"z-[21]\"\n  }, /* @__PURE__ */React5.createElement(Button, {\n    onClick: onCopyError\n  }, /* @__PURE__ */React5.createElement(Clipboard, {\n    weight: \"duotone\",\n    size: \"1em\"\n  }))), /* @__PURE__ */React5.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex-grow\"\n  }), /* @__PURE__ */React5.createElement(Button, {\n    variant: \"primary\",\n    onClick: () => location.reload()\n  }, t(\"reload page label\"))));\n};\n\n// packages/apps/patterns/react-appkit/src/components/HeadingWithActions/HeadingWithActions.tsx\nimport React6 from \"react\";\nimport { Heading as Heading2, mx as mx3 } from \"@dxos/react-uikit\";\nfunction _extends2() {\n  _extends2 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends2.apply(this, arguments);\n}\nvar HeadingWithActions = ({\n  heading,\n  actions,\n  compact,\n  spacer,\n  ...divProps\n}) => {\n  return /* @__PURE__ */React6.createElement(\"div\", _extends2({\n    role: \"none\"\n  }, divProps, {\n    className: mx3(\"flex flex-wrap items-center\", compact ? \"gap-2\" : \"gap-x-2 gap-y-4\", divProps.className)\n  }), /* @__PURE__ */React6.createElement(Heading2, _extends2({}, heading)), typeof spacer === \"undefined\" ? /* @__PURE__ */React6.createElement(\"div\", {\n    role: \"none\",\n    className: \"grow-[99] min-w-[2rem]\"\n  }) : spacer, /* @__PURE__ */React6.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex grow gap-2 items-center\"\n  }, actions));\n};\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/InvitationList.tsx\nimport React8 from \"react\";\nimport { defaultDisabled, Group, useTranslation as useTranslation6, mx as mx5 } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/PendingInvitation.tsx\nimport { ProhibitInset, XCircle } from \"phosphor-react\";\nimport React7, { useCallback as useCallback4 } from \"react\";\nimport { Invitation } from \"@dxos/client\";\nimport { useInvitationStatus } from \"@dxos/react-client\";\nimport { Avatar, Button as Button2, CompactQrCode, defaultGroup, getSize, Loading as Loading2, Tooltip as Tooltip4, InvitationStatus, useTranslation as useTranslation5, mx as mx4 } from \"@dxos/react-uikit\";\nfunction _extends3() {\n  _extends3 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends3.apply(this, arguments);\n}\nvar PendingInvitationSkeleton = ({\n  message\n}) => {\n  return /* @__PURE__ */React7.createElement(Loading2, {\n    label: message\n  });\n};\nvar PendingInvitation = ({\n  wrapper,\n  createInvitationUrl,\n  onClickRemove\n}) => {\n  const {\n    t\n  } = useTranslation5(\"uikit\");\n  const {\n    cancel,\n    status,\n    haltedAt,\n    authenticationCode,\n    invitationCode\n  } = useInvitationStatus(wrapper);\n  const handleRemove = useCallback4(() => {\n    var _a2;\n    const id = (_a2 = wrapper.invitation) == null ? void 0 : _a2.invitationId;\n    id && onClickRemove(id);\n  }, []);\n  return /* @__PURE__ */React7.createElement(\"div\", {\n    role: \"group\",\n    className: mx4(defaultGroup({\n      elevation: 1\n    }), \"mbe-2\")\n  }, wrapper.invitation ? /* @__PURE__ */React7.createElement(React7.Fragment, null, /* @__PURE__ */React7.createElement(HeadingWithActions, {\n    compact: true,\n    spacer: null,\n    heading: {\n      level: 2,\n      className: \"text-lg font-body flex gap-2 items-center grow-[99] pie-2\",\n      children: /* @__PURE__ */React7.createElement(Avatar, {\n        size: 10,\n        fallbackValue: wrapper.invitation.invitationId,\n        label: /* @__PURE__ */React7.createElement(InvitationStatus, _extends3({}, {\n          status,\n          haltedAt\n        }, {\n          className: \"grow\"\n        }))\n      })\n    },\n    actions: /* @__PURE__ */React7.createElement(React7.Fragment, null, status === Invitation.State.AUTHENTICATING ? /* @__PURE__ */React7.createElement(\"p\", {\n      className: \"text-xl text-center text-success-500 dark:text-success-300\"\n    }, authenticationCode) : /* @__PURE__ */React7.createElement(CompactQrCode, _extends3({}, {\n      copyLabel: t(\"copy space invite code short label\", {\n        ns: \"uikit\"\n      }),\n      displayQrLabel: t(\"display space invite qr code label\", {\n        ns: \"uikit\"\n      }),\n      value: createInvitationUrl(invitationCode)\n    })), status === Invitation.State.CANCELLED || status === Invitation.State.ERROR || status === Invitation.State.TIMEOUT || status === Invitation.State.SUCCESS ? /* @__PURE__ */React7.createElement(React7.Fragment, null, /* @__PURE__ */React7.createElement(Tooltip4, {\n      content: t(\"remove label\"),\n      tooltipLabelsTrigger: true\n    }, /* @__PURE__ */React7.createElement(Button2, {\n      className: \"flex md:hidden gap-1 items-center\",\n      onClick: handleRemove\n    }, /* @__PURE__ */React7.createElement(XCircle, {\n      className: getSize(5)\n    }))), /* @__PURE__ */React7.createElement(Button2, {\n      className: \"hidden md:flex gap-1 items-center\",\n      onClick: handleRemove\n    }, /* @__PURE__ */React7.createElement(XCircle, {\n      className: getSize(5)\n    }), /* @__PURE__ */React7.createElement(\"span\", null, t(\"remove label\")))) : /* @__PURE__ */React7.createElement(React7.Fragment, null, /* @__PURE__ */React7.createElement(Tooltip4, {\n      content: t(\"cancel label\"),\n      tooltipLabelsTrigger: true\n    }, /* @__PURE__ */React7.createElement(Button2, {\n      className: \"flex md:hidden gap-1 items-center\",\n      onClick: cancel\n    }, /* @__PURE__ */React7.createElement(ProhibitInset, {\n      className: getSize(5)\n    }))), /* @__PURE__ */React7.createElement(Button2, {\n      className: \"hidden md:flex gap-1 items-center\",\n      onClick: cancel\n    }, /* @__PURE__ */React7.createElement(ProhibitInset, {\n      className: getSize(5)\n    }), /* @__PURE__ */React7.createElement(\"span\", null, t(\"cancel label\")))))\n  })) : /* @__PURE__ */React7.createElement(PendingInvitationSkeleton, {\n    message: t(\"generic loading label\")\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/InvitationList.tsx\nvar InvitationList = ({\n  createInvitationUrl,\n  invitations,\n  onClickRemove\n}) => {\n  const {\n    t\n  } = useTranslation6(\"appkit\");\n  const empty = !invitations || invitations.length < 1;\n  return /* @__PURE__ */React8.createElement(Group, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: !empty ? t(\"invitations label\") : t(\"empty invitations message\"),\n      className: mx5(\"text-xl\", empty && defaultDisabled)\n    },\n    elevation: 0\n  }, !empty && invitations.map((wrapper, index) => {\n    var _a2, _b;\n    return /* @__PURE__ */React8.createElement(PendingInvitation, {\n      key: (_b = (_a2 = wrapper.invitation) == null ? void 0 : _a2.invitationId) != null ? _b : index,\n      wrapper,\n      createInvitationUrl,\n      onClickRemove\n    });\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/ManageSpacePage/ManageSpacePage.tsx\nimport { UserPlus } from \"phosphor-react\";\nimport React10, { useCallback as useCallback5, useMemo as useMemo2 } from \"react\";\nimport { useNavigate as useNavigate2, useParams as useParams2 } from \"react-router-dom\";\nimport urlJoin from \"url-join\";\nimport { useMembers, useSpace as useSpace2, useSpaceInvitations } from \"@dxos/react-client\";\nimport { Button as Button3, getSize as getSize2, useTranslation as useTranslation8 } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/components/ProfileList/ProfileList.tsx\nimport React9 from \"react\";\nimport { useIdentity as useIdentity2 } from \"@dxos/react-client\";\nimport { useTranslation as useTranslation7, Tag, Avatar as Avatar2, defaultDisabled as defaultDisabled2, defaultGroup as defaultGroup2, Group as Group2, mx as mx6 } from \"@dxos/react-uikit\";\nimport { humanize as humanize2 } from \"@dxos/util\";\nvar ProfileList = ({\n  profiles\n}) => {\n  const {\n    t\n  } = useTranslation7(\"appkit\");\n  const identity = useIdentity2();\n  const identityHex = identity == null ? void 0 : identity.identityKey.toHex();\n  return profiles.length > 0 ? /* @__PURE__ */React9.createElement(\"ul\", {\n    className: \"flex flex-col gap-2 mlb-4\"\n  }, profiles.map(profile => {\n    var _a2;\n    const profileHex = profile.identityKey.toHex();\n    return /* @__PURE__ */React9.createElement(\"li\", {\n      key: profileHex,\n      className: mx6(defaultGroup2({\n        elevation: 1,\n        spacing: \"p-1\",\n        rounding: \"rounded\"\n      }), \"flex gap-2 items-center\")\n    }, /* @__PURE__ */React9.createElement(Avatar2, {\n      variant: \"circle\",\n      fallbackValue: profileHex,\n      label: /* @__PURE__ */React9.createElement(\"p\", null, (_a2 = profile.displayName) != null ? _a2 : humanize2(profileHex), profileHex === identityHex && /* @__PURE__ */React9.createElement(Tag, {\n        valence: \"info\",\n        className: \"mli-2 align-middle\"\n      }, t(\"current identity label\")))\n    }));\n  })) : /* @__PURE__ */React9.createElement(Group2, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: t(\"empty members message\"),\n      className: mx6(\"text-xl\", defaultDisabled2)\n    },\n    elevation: 0\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/ManageSpacePage/ManageSpacePage.tsx\nvar defaultCreateInvitationUrl = invitationCode => {\n  const {\n    origin,\n    pathname\n  } = window.location;\n  return urlJoin(origin, pathname, `/#?invitation=${invitationCode}`);\n};\nvar ManageSpacePage = ({\n  createInvitationUrl = defaultCreateInvitationUrl,\n  spacesPath = \"/\"\n}) => {\n  const {\n    t\n  } = useTranslation8(\"appkit\");\n  const navigate = useNavigate2();\n  const {\n    space: spaceHex\n  } = useParams2();\n  const spaceKey = useSafeSpaceKey(spaceHex, () => navigate(spacesPath));\n  const space = useSpace2(spaceKey);\n  const members = useMembers(spaceKey);\n  const memberProfiles = useMemo2(() => members.map(({\n    profile\n  }) => profile).filter(profile => !!profile), [members]);\n  const invitations = useSpaceInvitations(space == null ? void 0 : space.key);\n  const handleCreateInvitation = useCallback5(() => {\n    if (space) {\n      space.createInvitation();\n    }\n  }, [space]);\n  const handleRemove = useCallback5(id => space == null ? void 0 : space.removeInvitation(id), [space]);\n  return /* @__PURE__ */React10.createElement(\"main\", {\n    className: \"max-is-5xl mli-auto pli-7\"\n  }, /* @__PURE__ */React10.createElement(HeadingWithActions, {\n    heading: {\n      level: 2,\n      children: t(\"space members label\", {\n        ns: \"uikit\"\n      })\n    },\n    actions: /* @__PURE__ */React10.createElement(React10.Fragment, null, /* @__PURE__ */React10.createElement(Button3, {\n      variant: \"primary\",\n      onClick: handleCreateInvitation,\n      className: \"flex gap-1 items-center\",\n      disabled: !space\n    }, /* @__PURE__ */React10.createElement(\"span\", null, t(\"create invitation label\")), /* @__PURE__ */React10.createElement(UserPlus, {\n      className: getSize2(5)\n    })))\n  }), /* @__PURE__ */React10.createElement(ProfileList, {\n    profiles: memberProfiles\n  }), /* @__PURE__ */React10.createElement(InvitationList, {\n    invitations,\n    createInvitationUrl,\n    onClickRemove: handleRemove\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/RequireIdentity/RequireIdentity.tsx\nimport React11, { useEffect as useEffect4 } from \"react\";\nimport { Outlet as Outlet2 } from \"react-router-dom\";\nimport { useIdentity as useIdentity3 } from \"@dxos/react-client\";\nvar RequireIdentity = ({\n  redirect: to\n}) => {\n  const identity = useIdentity3();\n  useEffect4(() => {\n    if (!identity) {\n      const redirect = `#?redirect=${encodeURIComponent(window.location.href)}`;\n      window.location.replace(`${to}${redirect}`);\n    }\n  }, []);\n  if (!identity) {\n    return null;\n  }\n  return /* @__PURE__ */React11.createElement(Outlet2, null);\n};\n\n// packages/apps/patterns/react-appkit/src/components/ServiceWorkerToast/ServiceWorkerToast.tsx\nimport { Gift } from \"phosphor-react\";\nimport React12 from \"react\";\nimport { useTranslation as useTranslation9, Toast, Button as Button4, getSize as getSize3, mx as mx7, useTranslationsContext } from \"@dxos/react-uikit\";\nfunction _extends4() {\n  _extends4 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends4.apply(this, arguments);\n}\nvar isNeedRefreshToast = props => props.variant === \"needRefresh\";\nvar ServiceWorkerToast = props => {\n  const {\n    t\n  } = useTranslation9(\"appkit\");\n  const {\n    appNs\n  } = useTranslationsContext();\n  const {\n    variant\n  } = props;\n  return /* @__PURE__ */React12.createElement(Toast, _extends4({\n    initiallyOpen: true,\n    title: variant === \"needRefresh\" ? /* @__PURE__ */React12.createElement(React12.Fragment, null, /* @__PURE__ */React12.createElement(Gift, {\n      className: mx7(getSize3(5), \"inline mr-1\"),\n      weight: \"duotone\"\n    }), /* @__PURE__ */React12.createElement(\"span\", null, t(\"need refresh label\"))) : t(\"offline ready label\", {\n      appName: t(\"current app name\", {\n        ns: appNs\n      })\n    })\n  }, isNeedRefreshToast(props) && {\n    duration: 24e4,\n    description: t(\"need refresh description\"),\n    actionTriggers: [{\n      altText: t(\"refresh alt\"),\n      trigger: /* @__PURE__ */React12.createElement(Button4, {\n        variant: \"primary\",\n        onClick: () => props.updateServiceWorker()\n      }, t(\"refresh label\"))\n    }]\n  }, variant === \"offlineReady\" && {\n    closeTrigger: /* @__PURE__ */React12.createElement(Button4, null, t(\"confirm label\", {\n      ns: \"uikit\"\n    }))\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/SpaceList/SpaceList.tsx\nimport React13 from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Avatar as Avatar3, defaultGroup as defaultGroup3, defaultHover, defaultFocus as defaultFocus2, useTranslation as useTranslation10, defaultDisabled as defaultDisabled3, Group as Group3, Heading as Heading3, mx as mx8 } from \"@dxos/react-uikit\";\nimport { humanize as humanize3 } from \"@dxos/util\";\nvar SpaceList = ({\n  spaces = []\n}) => {\n  const {\n    t\n  } = useTranslation10(\"appkit\");\n  return spaces.length ? /* @__PURE__ */React13.createElement(React13.Fragment, null, spaces.map(space => {\n    var _a2;\n    const keyHex = space.key.toHex();\n    const title = (_a2 = space.properties.get(\"title\")) != null ? _a2 : humanize3(keyHex);\n    return /* @__PURE__ */React13.createElement(Link, {\n      to: `/spaces/${keyHex}`,\n      role: \"group\",\n      key: keyHex,\n      className: mx8(defaultGroup3({\n        elevation: 1,\n        rounding: \"rounded\",\n        spacing: \"p-2\"\n      }), \"flex items-stretch gap-2 mbe-2\", defaultHover({}), defaultFocus2)\n    }, /* @__PURE__ */React13.createElement(Heading3, {\n      level: 2,\n      className: \"grow flex items-center mbe-0\"\n    }, /* @__PURE__ */React13.createElement(Avatar3, {\n      size: 12,\n      fallbackValue: keyHex,\n      label: /* @__PURE__ */React13.createElement(\"p\", {\n        className: \"text-lg grow\"\n      }, title),\n      slots: {\n        root: {\n          className: \"flex gap-1 items-center pr-2 rounded\"\n        }\n      }\n    })));\n  })) : /* @__PURE__ */React13.createElement(Group3, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: t(\"empty spaces label\"),\n      className: mx8(\"text-xl\", defaultDisabled3)\n    },\n    elevation: 0\n  }, /* @__PURE__ */React13.createElement(\"p\", {\n    className: defaultDisabled3\n  }, t(\"empty spaces message\")));\n};\n\n// packages/apps/patterns/react-appkit/src/components/SpacesPage/SpacesPage.tsx\nimport { Plus, Rocket } from \"phosphor-react\";\nimport React14, { useCallback as useCallback6 } from \"react\";\nimport { generatePath as generatePath2, useNavigate as useNavigate3, useSearchParams } from \"react-router-dom\";\nimport { useClient as useClient3, useSpaces } from \"@dxos/react-client\";\nimport { Button as Button5, getSize as getSize4, JoinDialog, useTranslation as useTranslation11 } from \"@dxos/react-uikit\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar invitationCodeFromUrl = text => {\n  try {\n    const searchParams = new URLSearchParams(text.substring(text.lastIndexOf(\"?\")));\n    const invitation = searchParams.get(\"invitation\");\n    return invitation != null ? invitation : text;\n  } catch (err) {\n    console.error(err);\n    return text;\n  }\n};\nvar SpacesPage = ({\n  onSpaceCreate,\n  spacePath = \"/spaces/:space\"\n}) => {\n  const {\n    t\n  } = useTranslation11(\"appkit\");\n  const client = useClient3();\n  const spaces = useSpaces();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate3();\n  const invitationParam = searchParams.get(\"invitation\");\n  const acceptInvitation = useCallback6(invitation => client.echo.acceptInvitation(invitation), [client]);\n  const handleCreateSpace = useCallback6(async () => {\n    const space = await client.echo.createSpace();\n    await (onSpaceCreate == null ? void 0 : onSpaceCreate(space));\n  }, [client]);\n  const handleJoin = useCallback6(({\n    spaceKey\n  }) => navigate(generatePath2(spacePath, {\n    space: spaceKey.toHex()\n  })), [spacePath]);\n  return /* @__PURE__ */React14.createElement(React14.Fragment, null, /* @__PURE__ */React14.createElement(HeadingWithActions, {\n    className: \"flex-auto text-center mbe-4\",\n    actions: /* @__PURE__ */React14.createElement(React14.Fragment, null, /* @__PURE__ */React14.createElement(JoinDialog, {\n      initialInvitationCode: invitationParam != null ? invitationParam : void 0,\n      parseInvitation: invitationCode => invitationCodeFromUrl(invitationCode),\n      onJoin: handleJoin,\n      acceptInvitation,\n      dialogProps: {\n        initiallyOpen: Boolean(invitationParam),\n        openTrigger: /* @__PURE__ */React14.createElement(Button5, {\n          className: \"grow flex gap-1\"\n        }, /* @__PURE__ */React14.createElement(Rocket, {\n          className: getSize4(5)\n        }), t(\"join space label\", {\n          ns: \"uikit\"\n        }))\n      }\n    }), /* @__PURE__ */React14.createElement(Button5, {\n      variant: \"primary\",\n      onClick: handleCreateSpace,\n      className: \"grow flex gap-1\"\n    }, /* @__PURE__ */React14.createElement(Plus, {\n      className: getSize4(5)\n    }), t(\"create space label\", {\n      ns: \"uikit\"\n    }))),\n    heading: {\n      children: t(\"spaces label\")\n    }\n  }), /* @__PURE__ */React14.createElement(SpaceList, {\n    spaces\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/translations/en-US.ts\nvar en_US_exports = {};\n__export(en_US_exports, {\n  appkit: () => appkit\n});\nvar appkit = {\n  \"list title label\": \"List title\",\n  \"list title placeholder\": \"Untitled list\",\n  \"list description label\": \"List description\",\n  \"list description placeholder\": \"Add an optional description\",\n  \"list item title label\": \"List item title\",\n  \"list item title placeholder\": \"Type here\",\n  \"list item description label\": \"List item description\",\n  \"list item description placeholder\": \"Add an optional description\",\n  \"move list item up label\": \"Move list item up\",\n  \"move list item down label\": \"Move list item down\",\n  \"delete list item label\": \"Remove list item\",\n  \"add list item label\": \"Add list item\",\n  \"need refresh label\": \"Refresh now to get app updates\",\n  \"need refresh description\": \"You\\u2019ll need these updates to continue without interruption.\",\n  \"refresh label\": \"Refresh\",\n  \"refresh alt\": \"Click your browser\\u2019s refresh button or use the refresh keyboard shortcut.\",\n  \"offline ready label\": \"{appName} is ready to use offline.\",\n  \"spaces label\": \"Spaces\",\n  \"empty invitations message\": \"No pending invitations\",\n  \"invitations label\": \"Invitations\",\n  \"create invitation label\": \"Invite\",\n  \"current identity label\": \"You\",\n  \"empty members message\": \"No members in this space\",\n  \"composer placeholder\": \"Write something\\u2026\",\n  \"heartbeat stalled\": \"Heartbeat stalled\",\n  \"empty spaces label\": \"No spaces here\",\n  \"empty spaces message\": \"Why not try creating or joining one?\"\n};\n\n// packages/apps/patterns/react-appkit/src/translations/index.ts\nvar translations = {\n  \"en-US\": en_US_exports\n};\nexport { AppLayout, BASE_TELEMETRY_PROPERTIES, DX_ENVIRONMENT, DX_GROUP, DX_RELEASE, DX_TELEMETRY, ErrorContext, ErrorProvider, Fallback, FatalError, GenericFallback, HeadingWithActions, InvitationList, ManageSpacePage, ProfileList, RequireIdentity, ServiceWorkerToast, SpaceList, SpacesPage, StatusIndicator, getTelemetryIdentifier, setupTelemetryListeners, translations, useErrors, useSafeSpaceKey, useTelemetry };","start":1670465438693,"end":1670465438855,"order":"pre"},{"name":"vite:define","result":"var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all) __defProp(target, name, {\n    get: all[name],\n    enumerable: true\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/AppLayout/AppLayout.tsx\nimport React2, { useCallback } from \"react\";\nimport { generatePath, Outlet, useLocation as useLocation2, useNavigate, useParams } from \"react-router-dom\";\nimport { useClient as useClient2, useIdentity, useSpace, useStatus } from \"@dxos/react-client\";\nimport { Menubar } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/hooks/useSafeSpaceKey.ts\nimport { useEffect, useState } from \"react\";\nimport { PublicKey } from \"@dxos/keys\";\nimport { log } from \"@dxos/log\";\nvar useSafeSpaceKey = (hex, onFailure) => {\n  const [spaceKey, setSpaceKey] = useState();\n  useEffect(() => {\n    if (hex) {\n      try {\n        setSpaceKey(PublicKey.fromHex(hex));\n      } catch (e) {\n        log.warn(\"invalid space key\", {\n          hex\n        }, {\n          file: \"/home/jdw/Code/dxos/dxos/packages/apps/patterns/react-appkit/src/hooks/useSafeSpaceKey.ts\",\n          line: 23,\n          scope: void 0,\n          callSite: (f, a) => f(...a)\n        });\n        onFailure == null ? void 0 : onFailure();\n      }\n    } else {\n      setSpaceKey(void 0);\n    }\n  }, [hex]);\n  return spaceKey;\n};\n\n// packages/apps/patterns/react-appkit/src/hooks/useTelemetry.ts\nimport { useEffect as useEffect2, useMemo } from \"react\";\nimport { useLocation } from \"react-router-dom\";\nimport { useAsyncEffect } from \"@dxos/react-async\";\nimport { useClient } from \"@dxos/react-client\";\nimport * as Sentry from \"@dxos/sentry\";\nimport * as Telemetry2 from \"@dxos/telemetry\";\n\n// packages/apps/patterns/react-appkit/src/telemetry/base-properties.ts\nimport { captureException } from \"@dxos/sentry\";\nimport { humanize } from \"@dxos/util\";\nvar IPDATA_API_KEY = undefined;\nvar DX_TELEMETRY = localStorage.getItem(\"halo-app:telemetry-disabled\");\nvar DX_GROUP = localStorage.getItem(\"halo-app:telemetry-group\");\nvar DX_ENVIRONMENT = undefined;\nvar DX_RELEASE = \"@dxos/halo-app@0.1.13\";\nvar BASE_TELEMETRY_PROPERTIES = {\n  environment: DX_ENVIRONMENT,\n  release: DX_RELEASE,\n  group: DX_GROUP\n};\nvar _a;\nif ((_a = navigator.storage) == null ? void 0 : _a.estimate) {\n  setInterval(async () => {\n    const storageEstimate = await navigator.storage.estimate();\n    BASE_TELEMETRY_PROPERTIES.storageUsage = storageEstimate.usage;\n    BASE_TELEMETRY_PROPERTIES.storageQuota = storageEstimate.quota;\n  }, 1e4);\n}\nvoid fetch(`https://api.ipdata.co?api-key=${IPDATA_API_KEY}`).then(res => res.json()).then(data => {\n  BASE_TELEMETRY_PROPERTIES.city = data.city;\n  BASE_TELEMETRY_PROPERTIES.region = data.region;\n  BASE_TELEMETRY_PROPERTIES.country = data.country;\n  BASE_TELEMETRY_PROPERTIES.latitude = data.latitude;\n  BASE_TELEMETRY_PROPERTIES.longitude = data.longitude;\n}).catch(err => captureException(err));\nvar getTelemetryIdentifier = client => {\n  const profile = client.halo.profile;\n  if (profile) {\n    humanize(profile.identityKey);\n  }\n  return void 0;\n};\n\n// packages/apps/patterns/react-appkit/src/telemetry/listeners.ts\nimport * as Telemetry from \"@dxos/telemetry\";\nvar lastFocusEvent = new Date();\nvar totalTime = 0;\nvar setupTelemetryListeners = (namespace, client) => {\n  const clickCallback = event3 => {\n    if (DX_GROUP === \"dxos\" && event3.target && !event3.target.id) {\n      console.warn(\"Click event on element without id:\", event3.target);\n    }\n    setTimeout(() => {\n      var _a2, _b;\n      return Telemetry.event({\n        identityId: getTelemetryIdentifier(client),\n        name: `${namespace}.window.click`,\n        properties: {\n          ...BASE_TELEMETRY_PROPERTIES,\n          href: window.location.href,\n          id: (_a2 = event3.target) == null ? void 0 : _a2.id,\n          path: (_b = event3.path) == null ? void 0 : _b.filter(el => Boolean(el.tagName)).map(el => `${el.tagName.toLowerCase()}${el.id ? `#${el.id}` : \"\"}`).reverse().join(\">\")\n        }\n      });\n    });\n  };\n  const focusCallback = () => {\n    const now = new Date();\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.window.focus`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeAway: now.getTime() - lastFocusEvent.getTime()\n      }\n    }));\n    lastFocusEvent = now;\n  };\n  const blurCallback = () => {\n    const now = new Date();\n    const timeSpent = now.getTime() - lastFocusEvent.getTime();\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.window.blur`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeSpent\n      }\n    }));\n    lastFocusEvent = now;\n    totalTime = totalTime + timeSpent;\n  };\n  const unloadCallback = () => {\n    setTimeout(() => Telemetry.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.page.unload`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        timeSpent: totalTime\n      }\n    }));\n  };\n  window.addEventListener(\"click\", clickCallback, true);\n  window.addEventListener(\"focus\", focusCallback);\n  window.addEventListener(\"blur\", blurCallback);\n  window.addEventListener(\"beforeunload\", unloadCallback);\n  return () => {\n    window.removeEventListener(\"click\", clickCallback, true);\n    window.removeEventListener(\"focus\", focusCallback);\n    window.removeEventListener(\"blur\", blurCallback);\n    window.removeEventListener(\"beforeunload\", unloadCallback);\n  };\n};\n\n// packages/apps/patterns/react-appkit/src/hooks/useTelemetry.ts\nvar SENTRY_DESTINATION = undefined;\nvar TELEMETRY_API_KEY = undefined;\nvar useTelemetry = ({\n  namespace,\n  router = true\n}) => {\n  const location2 = router ? useLocation() : null;\n  const client = useClient();\n  const telemetryDisabled = useMemo(() => DX_TELEMETRY === \"true\", []);\n  useEffect2(() => {\n    if (SENTRY_DESTINATION && !telemetryDisabled) {\n      Sentry.init({\n        destination: SENTRY_DESTINATION,\n        environment: DX_ENVIRONMENT,\n        release: DX_RELEASE,\n        sampleRate: 1\n      });\n    }\n    Telemetry2.init({\n      apiKey: TELEMETRY_API_KEY,\n      enable: Boolean(TELEMETRY_API_KEY) && !telemetryDisabled\n    });\n    Telemetry2.event({\n      identityId: getTelemetryIdentifier(client),\n      name: `${namespace}.page.load`,\n      properties: {\n        ...BASE_TELEMETRY_PROPERTIES,\n        href: window.location.href,\n        loadDuration: window.performance.timing.loadEventEnd - window.performance.timing.loadEventStart\n      }\n    });\n    return setupTelemetryListeners(namespace, client);\n  }, []);\n  useAsyncEffect(async () => {\n    Telemetry2.page({\n      identityId: getTelemetryIdentifier(client),\n      properties: BASE_TELEMETRY_PROPERTIES\n    });\n  }, [location2]);\n};\n\n// packages/apps/patterns/react-appkit/src/components/StatusIndicator/StatusIndicator.tsx\nimport React from \"react\";\nimport { Tooltip, useTranslation, valenceColorText, mx } from \"@dxos/react-uikit\";\nvar StatusIndicator = ({\n  status\n}) => {\n  const {\n    t\n  } = useTranslation();\n  return /* @__PURE__ */React.createElement(\"div\", {\n    role: \"none\",\n    className: mx(\"fixed bottom-4 right-4\", valenceColorText(\"success\"))\n  }, status && /* @__PURE__ */React.createElement(\"span\", {\n    className: \"flex h-3 w-3\"\n  }, /* @__PURE__ */React.createElement(\"span\", {\n    className: \"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-600 opacity-75\"\n  }), /* @__PURE__ */React.createElement(\"span\", {\n    className: \"relative inline-flex rounded-full h-3 w-3 bg-green-700\"\n  })), !status && /* @__PURE__ */React.createElement(Tooltip, {\n    content: t(\"heartbeat stalled\")\n  }, /* @__PURE__ */React.createElement(\"span\", {\n    className: \"flex h-3 w-3\"\n  }, /* @__PURE__ */React.createElement(\"span\", {\n    className: \"relative inline-flex rounded-full h-3 w-3 bg-red-500\"\n  }))));\n};\n\n// packages/apps/patterns/react-appkit/src/components/AppLayout/AppLayout.tsx\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nvar StatusContainer = () => {\n  const status = useStatus();\n  return (\n    /*#__PURE__*/\n    /* @__PURE__ */\n    _jsx(StatusIndicator, {\n      status: status\n    })\n  );\n};\nvar AppLayout = ({\n  spacesPath = \"/spaces\",\n  spacePath = \"/spaces/:space\",\n  manageSpacePath = \"/spaces/:space/settings\",\n  manageProfilePath,\n  suppressSpaceMenu,\n  menubarContent\n}) => {\n  const client = useClient2();\n  const identity = useIdentity();\n  const {\n    space: spaceHex\n  } = useParams();\n  const spaceKey = useSafeSpaceKey(spaceHex, () => navigate(spacesPath));\n  const space = useSpace(spaceKey);\n  const navigate = useNavigate();\n  const location2 = useLocation2();\n  const pathSegments = location2.pathname.split(\"/\").length;\n  const isManagingSpace = !!spaceHex && pathSegments > 3;\n  const handleManageProfile = useCallback(() => {\n    if (manageProfilePath) {\n      navigate(manageProfilePath);\n    } else {\n      const remoteSource = new URL(client.config.get(\"runtime.client.remoteSource\") || \"https://halo.dxos.org\");\n      const tab = window.open(remoteSource.origin, \"_blank\");\n      tab == null ? void 0 : tab.focus();\n    }\n  }, [client, navigate, manageProfilePath]);\n  const handleGoToSpace = useCallback(() => navigate(generatePath(spacePath, {\n    space: spaceHex\n  })), [navigate, spaceHex]);\n  const handleManageSpace = useCallback(() => navigate(generatePath(manageSpacePath, {\n    space: spaceHex\n  })), [navigate, spaceHex]);\n  const handleGoToSpaces = useCallback(() => navigate(spacesPath), [navigate]);\n  return (\n    /*#__PURE__*/\n    /* @__PURE__ */\n    _jsxs(_Fragment, {\n      children: [/*#__PURE__*/_jsx(Menubar, {\n        profile: identity,\n        space: space,\n        ...(isManagingSpace && {\n          onClickGoToSpace: handleGoToSpace\n        }),\n        ...(space && {\n          onClickGoToSpaces: handleGoToSpaces\n        }),\n        ...(!suppressSpaceMenu && {\n          onClickManageSpace: handleManageSpace\n        }),\n        onClickManageProfile: handleManageProfile,\n        children: menubarContent\n      }), /*#__PURE__*/_jsx(StatusContainer, {}), /*#__PURE__*/_jsx(\"main\", {\n        className: \"max-is-5xl mli-auto pli-7 pbs-16\",\n        children: /*#__PURE__*/_jsx(Outlet, {\n          context: {\n            space\n          }\n        })\n      })]\n    })\n  );\n};\n\n// packages/apps/patterns/react-appkit/src/components/ErrorProvider/ErrorProvider.tsx\nimport { Warning } from \"phosphor-react\";\nimport React3, { createContext, useCallback as useCallback2, useContext, useEffect as useEffect3, useState as useState2 } from \"react\";\nimport { Tooltip as Tooltip2, valenceColorText as valenceColorText2, defaultFocus, useTranslation as useTranslation2, mx as mx2 } from \"@dxos/react-uikit\";\nimport { captureException as captureException2 } from \"@dxos/sentry\";\nvar ErrorContext = /* @__PURE__ */createContext({\n  errors: [],\n  addError: () => {},\n  resetErrors: () => {}\n});\nvar logError = (f, ...args) => console.error(f, ...args);\nvar ErrorProvider = ({\n  children\n}) => {\n  const {\n    t\n  } = useTranslation2();\n  const [errors, setErrors] = useState2([]);\n  const addError = useCallback2(error => setErrors([error, ...errors]), []);\n  const resetErrors = useCallback2(() => setErrors([]), []);\n  const onUnhandledRejection = useCallback2(event3 => {\n    captureException2(event3.reason);\n    logError(\"unhandledrejection\", event3.reason);\n    addError(event3.reason);\n    event3.preventDefault();\n  }, []);\n  const onWindowError = useCallback2((message, source, lineno, colno, error) => {\n    captureException2(error);\n    logError(\"onerror\", message);\n    addError(error);\n    return true;\n  }, []);\n  useEffect3(() => {\n    window.onerror = onWindowError;\n    window.addEventListener(\"unhandledrejection\", onUnhandledRejection);\n    return () => {\n      window.onerror = null;\n      window.removeEventListener(\"unhandledrejection\", onUnhandledRejection);\n    };\n  }, []);\n  return /* @__PURE__ */React3.createElement(ErrorContext.Provider, {\n    value: {\n      errors,\n      addError,\n      resetErrors\n    }\n  }, children, /* @__PURE__ */React3.createElement(\"div\", {\n    role: \"none\",\n    className: mx2(\"fixed bottom-4 right-4\", valenceColorText2(\"warning\"))\n  }, !!errors.length && /* @__PURE__ */React3.createElement(Tooltip2, {\n    content: t(\"caught error message\")\n  }, /* @__PURE__ */React3.createElement(Warning, {\n    tabIndex: 0,\n    weight: \"duotone\",\n    className: mx2(\"w-6 h-6 rounded-md\", defaultFocus)\n  }))));\n};\nvar useErrors = () => useContext(ErrorContext);\n\n// packages/apps/patterns/react-appkit/src/components/Fallback/Fallback.tsx\nimport React4 from \"react\";\nimport { Heading, Loading, useTranslation as useTranslation3 } from \"@dxos/react-uikit\";\nvar Fallback = ({\n  message\n}) => /* @__PURE__ */React4.createElement(\"div\", {\n  className: \"py-8 flex flex-col gap-4\",\n  \"aria-live\": \"polite\"\n}, /* @__PURE__ */React4.createElement(Loading, {\n  label: message,\n  size: \"lg\"\n}), /* @__PURE__ */React4.createElement(Heading, {\n  level: 1,\n  className: \"text-lg font-light text-center\"\n}, message));\nvar GenericFallback = () => {\n  const {\n    t\n  } = useTranslation3(\"uikit\");\n  return /* @__PURE__ */React4.createElement(Fallback, {\n    message: t(\"generic loading label\")\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/FatalError/FatalError.tsx\nimport { Clipboard } from \"phosphor-react\";\nimport React5, { useCallback as useCallback3 } from \"react\";\nimport { Alert, Button, Dialog, Tooltip as Tooltip3, useTranslation as useTranslation4 } from \"@dxos/react-uikit\";\nvar FatalError = ({\n  error\n}) => {\n  const {\n    t\n  } = useTranslation4();\n  const isDev = true;\n  const message = String(error);\n  let stack = String(error == null ? void 0 : error.stack);\n  if (stack.indexOf(message) === 0) {\n    stack = stack.substr(message.length).trim();\n  }\n  stack = stack.split(\"\\n\").map(text => text.trim()).join(\"\\n\");\n  const onCopyError = useCallback3(() => {\n    void navigator.clipboard.writeText(JSON.stringify({\n      message,\n      stack\n    }));\n  }, [message, stack]);\n  return /* @__PURE__ */React5.createElement(Dialog, {\n    title: t(\"fatal error label\"),\n    initiallyOpen: true\n  }, isDev ? /* @__PURE__ */React5.createElement(Alert, {\n    title: message,\n    valence: \"error\",\n    slots: {\n      root: {\n        className: \"mlb-4\"\n      }\n    }\n  }, /* @__PURE__ */React5.createElement(\"pre\", {\n    className: \"text-xs overflow-auto max-w-72 max-h-72\"\n  }, stack)) : /* @__PURE__ */React5.createElement(\"p\", null, t(\"fatal error message\")), /* @__PURE__ */React5.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex\"\n  }, /* @__PURE__ */React5.createElement(Tooltip3, {\n    content: t(\"copy error label\"),\n    zIndex: \"z-[21]\"\n  }, /* @__PURE__ */React5.createElement(Button, {\n    onClick: onCopyError\n  }, /* @__PURE__ */React5.createElement(Clipboard, {\n    weight: \"duotone\",\n    size: \"1em\"\n  }))), /* @__PURE__ */React5.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex-grow\"\n  }), /* @__PURE__ */React5.createElement(Button, {\n    variant: \"primary\",\n    onClick: () => location.reload()\n  }, t(\"reload page label\"))));\n};\n\n// packages/apps/patterns/react-appkit/src/components/HeadingWithActions/HeadingWithActions.tsx\nimport React6 from \"react\";\nimport { Heading as Heading2, mx as mx3 } from \"@dxos/react-uikit\";\nfunction _extends2() {\n  _extends2 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends2.apply(this, arguments);\n}\nvar HeadingWithActions = ({\n  heading,\n  actions,\n  compact,\n  spacer,\n  ...divProps\n}) => {\n  return /* @__PURE__ */React6.createElement(\"div\", _extends2({\n    role: \"none\"\n  }, divProps, {\n    className: mx3(\"flex flex-wrap items-center\", compact ? \"gap-2\" : \"gap-x-2 gap-y-4\", divProps.className)\n  }), /* @__PURE__ */React6.createElement(Heading2, _extends2({}, heading)), typeof spacer === \"undefined\" ? /* @__PURE__ */React6.createElement(\"div\", {\n    role: \"none\",\n    className: \"grow-[99] min-w-[2rem]\"\n  }) : spacer, /* @__PURE__ */React6.createElement(\"div\", {\n    role: \"none\",\n    className: \"flex grow gap-2 items-center\"\n  }, actions));\n};\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/InvitationList.tsx\nimport React8 from \"react\";\nimport { defaultDisabled, Group, useTranslation as useTranslation6, mx as mx5 } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/PendingInvitation.tsx\nimport { ProhibitInset, XCircle } from \"phosphor-react\";\nimport React7, { useCallback as useCallback4 } from \"react\";\nimport { Invitation } from \"@dxos/client\";\nimport { useInvitationStatus } from \"@dxos/react-client\";\nimport { Avatar, Button as Button2, CompactQrCode, defaultGroup, getSize, Loading as Loading2, Tooltip as Tooltip4, InvitationStatus, useTranslation as useTranslation5, mx as mx4 } from \"@dxos/react-uikit\";\nfunction _extends3() {\n  _extends3 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends3.apply(this, arguments);\n}\nvar PendingInvitationSkeleton = ({\n  message\n}) => {\n  return /* @__PURE__ */React7.createElement(Loading2, {\n    label: message\n  });\n};\nvar PendingInvitation = ({\n  wrapper,\n  createInvitationUrl,\n  onClickRemove\n}) => {\n  const {\n    t\n  } = useTranslation5(\"uikit\");\n  const {\n    cancel,\n    status,\n    haltedAt,\n    authenticationCode,\n    invitationCode\n  } = useInvitationStatus(wrapper);\n  const handleRemove = useCallback4(() => {\n    var _a2;\n    const id = (_a2 = wrapper.invitation) == null ? void 0 : _a2.invitationId;\n    id && onClickRemove(id);\n  }, []);\n  return /* @__PURE__ */React7.createElement(\"div\", {\n    role: \"group\",\n    className: mx4(defaultGroup({\n      elevation: 1\n    }), \"mbe-2\")\n  }, wrapper.invitation ? /* @__PURE__ */React7.createElement(React7.Fragment, null, /* @__PURE__ */React7.createElement(HeadingWithActions, {\n    compact: true,\n    spacer: null,\n    heading: {\n      level: 2,\n      className: \"text-lg font-body flex gap-2 items-center grow-[99] pie-2\",\n      children: /* @__PURE__ */React7.createElement(Avatar, {\n        size: 10,\n        fallbackValue: wrapper.invitation.invitationId,\n        label: /* @__PURE__ */React7.createElement(InvitationStatus, _extends3({}, {\n          status,\n          haltedAt\n        }, {\n          className: \"grow\"\n        }))\n      })\n    },\n    actions: /* @__PURE__ */React7.createElement(React7.Fragment, null, status === Invitation.State.AUTHENTICATING ? /* @__PURE__ */React7.createElement(\"p\", {\n      className: \"text-xl text-center text-success-500 dark:text-success-300\"\n    }, authenticationCode) : /* @__PURE__ */React7.createElement(CompactQrCode, _extends3({}, {\n      copyLabel: t(\"copy space invite code short label\", {\n        ns: \"uikit\"\n      }),\n      displayQrLabel: t(\"display space invite qr code label\", {\n        ns: \"uikit\"\n      }),\n      value: createInvitationUrl(invitationCode)\n    })), status === Invitation.State.CANCELLED || status === Invitation.State.ERROR || status === Invitation.State.TIMEOUT || status === Invitation.State.SUCCESS ? /* @__PURE__ */React7.createElement(React7.Fragment, null, /* @__PURE__ */React7.createElement(Tooltip4, {\n      content: t(\"remove label\"),\n      tooltipLabelsTrigger: true\n    }, /* @__PURE__ */React7.createElement(Button2, {\n      className: \"flex md:hidden gap-1 items-center\",\n      onClick: handleRemove\n    }, /* @__PURE__ */React7.createElement(XCircle, {\n      className: getSize(5)\n    }))), /* @__PURE__ */React7.createElement(Button2, {\n      className: \"hidden md:flex gap-1 items-center\",\n      onClick: handleRemove\n    }, /* @__PURE__ */React7.createElement(XCircle, {\n      className: getSize(5)\n    }), /* @__PURE__ */React7.createElement(\"span\", null, t(\"remove label\")))) : /* @__PURE__ */React7.createElement(React7.Fragment, null, /* @__PURE__ */React7.createElement(Tooltip4, {\n      content: t(\"cancel label\"),\n      tooltipLabelsTrigger: true\n    }, /* @__PURE__ */React7.createElement(Button2, {\n      className: \"flex md:hidden gap-1 items-center\",\n      onClick: cancel\n    }, /* @__PURE__ */React7.createElement(ProhibitInset, {\n      className: getSize(5)\n    }))), /* @__PURE__ */React7.createElement(Button2, {\n      className: \"hidden md:flex gap-1 items-center\",\n      onClick: cancel\n    }, /* @__PURE__ */React7.createElement(ProhibitInset, {\n      className: getSize(5)\n    }), /* @__PURE__ */React7.createElement(\"span\", null, t(\"cancel label\")))))\n  })) : /* @__PURE__ */React7.createElement(PendingInvitationSkeleton, {\n    message: t(\"generic loading label\")\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/InvitationList/InvitationList.tsx\nvar InvitationList = ({\n  createInvitationUrl,\n  invitations,\n  onClickRemove\n}) => {\n  const {\n    t\n  } = useTranslation6(\"appkit\");\n  const empty = !invitations || invitations.length < 1;\n  return /* @__PURE__ */React8.createElement(Group, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: !empty ? t(\"invitations label\") : t(\"empty invitations message\"),\n      className: mx5(\"text-xl\", empty && defaultDisabled)\n    },\n    elevation: 0\n  }, !empty && invitations.map((wrapper, index) => {\n    var _a2, _b;\n    return /* @__PURE__ */React8.createElement(PendingInvitation, {\n      key: (_b = (_a2 = wrapper.invitation) == null ? void 0 : _a2.invitationId) != null ? _b : index,\n      wrapper,\n      createInvitationUrl,\n      onClickRemove\n    });\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/ManageSpacePage/ManageSpacePage.tsx\nimport { UserPlus } from \"phosphor-react\";\nimport React10, { useCallback as useCallback5, useMemo as useMemo2 } from \"react\";\nimport { useNavigate as useNavigate2, useParams as useParams2 } from \"react-router-dom\";\nimport urlJoin from \"url-join\";\nimport { useMembers, useSpace as useSpace2, useSpaceInvitations } from \"@dxos/react-client\";\nimport { Button as Button3, getSize as getSize2, useTranslation as useTranslation8 } from \"@dxos/react-uikit\";\n\n// packages/apps/patterns/react-appkit/src/components/ProfileList/ProfileList.tsx\nimport React9 from \"react\";\nimport { useIdentity as useIdentity2 } from \"@dxos/react-client\";\nimport { useTranslation as useTranslation7, Tag, Avatar as Avatar2, defaultDisabled as defaultDisabled2, defaultGroup as defaultGroup2, Group as Group2, mx as mx6 } from \"@dxos/react-uikit\";\nimport { humanize as humanize2 } from \"@dxos/util\";\nvar ProfileList = ({\n  profiles\n}) => {\n  const {\n    t\n  } = useTranslation7(\"appkit\");\n  const identity = useIdentity2();\n  const identityHex = identity == null ? void 0 : identity.identityKey.toHex();\n  return profiles.length > 0 ? /* @__PURE__ */React9.createElement(\"ul\", {\n    className: \"flex flex-col gap-2 mlb-4\"\n  }, profiles.map(profile => {\n    var _a2;\n    const profileHex = profile.identityKey.toHex();\n    return /* @__PURE__ */React9.createElement(\"li\", {\n      key: profileHex,\n      className: mx6(defaultGroup2({\n        elevation: 1,\n        spacing: \"p-1\",\n        rounding: \"rounded\"\n      }), \"flex gap-2 items-center\")\n    }, /* @__PURE__ */React9.createElement(Avatar2, {\n      variant: \"circle\",\n      fallbackValue: profileHex,\n      label: /* @__PURE__ */React9.createElement(\"p\", null, (_a2 = profile.displayName) != null ? _a2 : humanize2(profileHex), profileHex === identityHex && /* @__PURE__ */React9.createElement(Tag, {\n        valence: \"info\",\n        className: \"mli-2 align-middle\"\n      }, t(\"current identity label\")))\n    }));\n  })) : /* @__PURE__ */React9.createElement(Group2, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: t(\"empty members message\"),\n      className: mx6(\"text-xl\", defaultDisabled2)\n    },\n    elevation: 0\n  });\n};\n\n// packages/apps/patterns/react-appkit/src/components/ManageSpacePage/ManageSpacePage.tsx\nvar defaultCreateInvitationUrl = invitationCode => {\n  const {\n    origin,\n    pathname\n  } = window.location;\n  return urlJoin(origin, pathname, `/#?invitation=${invitationCode}`);\n};\nvar ManageSpacePage = ({\n  createInvitationUrl = defaultCreateInvitationUrl,\n  spacesPath = \"/\"\n}) => {\n  const {\n    t\n  } = useTranslation8(\"appkit\");\n  const navigate = useNavigate2();\n  const {\n    space: spaceHex\n  } = useParams2();\n  const spaceKey = useSafeSpaceKey(spaceHex, () => navigate(spacesPath));\n  const space = useSpace2(spaceKey);\n  const members = useMembers(spaceKey);\n  const memberProfiles = useMemo2(() => members.map(({\n    profile\n  }) => profile).filter(profile => !!profile), [members]);\n  const invitations = useSpaceInvitations(space == null ? void 0 : space.key);\n  const handleCreateInvitation = useCallback5(() => {\n    if (space) {\n      space.createInvitation();\n    }\n  }, [space]);\n  const handleRemove = useCallback5(id => space == null ? void 0 : space.removeInvitation(id), [space]);\n  return /* @__PURE__ */React10.createElement(\"main\", {\n    className: \"max-is-5xl mli-auto pli-7\"\n  }, /* @__PURE__ */React10.createElement(HeadingWithActions, {\n    heading: {\n      level: 2,\n      children: t(\"space members label\", {\n        ns: \"uikit\"\n      })\n    },\n    actions: /* @__PURE__ */React10.createElement(React10.Fragment, null, /* @__PURE__ */React10.createElement(Button3, {\n      variant: \"primary\",\n      onClick: handleCreateInvitation,\n      className: \"flex gap-1 items-center\",\n      disabled: !space\n    }, /* @__PURE__ */React10.createElement(\"span\", null, t(\"create invitation label\")), /* @__PURE__ */React10.createElement(UserPlus, {\n      className: getSize2(5)\n    })))\n  }), /* @__PURE__ */React10.createElement(ProfileList, {\n    profiles: memberProfiles\n  }), /* @__PURE__ */React10.createElement(InvitationList, {\n    invitations,\n    createInvitationUrl,\n    onClickRemove: handleRemove\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/RequireIdentity/RequireIdentity.tsx\nimport React11, { useEffect as useEffect4 } from \"react\";\nimport { Outlet as Outlet2 } from \"react-router-dom\";\nimport { useIdentity as useIdentity3 } from \"@dxos/react-client\";\nvar RequireIdentity = ({\n  redirect: to\n}) => {\n  const identity = useIdentity3();\n  useEffect4(() => {\n    if (!identity) {\n      const redirect = `#?redirect=${encodeURIComponent(window.location.href)}`;\n      window.location.replace(`${to}${redirect}`);\n    }\n  }, []);\n  if (!identity) {\n    return null;\n  }\n  return /* @__PURE__ */React11.createElement(Outlet2, null);\n};\n\n// packages/apps/patterns/react-appkit/src/components/ServiceWorkerToast/ServiceWorkerToast.tsx\nimport { Gift } from \"phosphor-react\";\nimport React12 from \"react\";\nimport { useTranslation as useTranslation9, Toast, Button as Button4, getSize as getSize3, mx as mx7, useTranslationsContext } from \"@dxos/react-uikit\";\nfunction _extends4() {\n  _extends4 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends4.apply(this, arguments);\n}\nvar isNeedRefreshToast = props => props.variant === \"needRefresh\";\nvar ServiceWorkerToast = props => {\n  const {\n    t\n  } = useTranslation9(\"appkit\");\n  const {\n    appNs\n  } = useTranslationsContext();\n  const {\n    variant\n  } = props;\n  return /* @__PURE__ */React12.createElement(Toast, _extends4({\n    initiallyOpen: true,\n    title: variant === \"needRefresh\" ? /* @__PURE__ */React12.createElement(React12.Fragment, null, /* @__PURE__ */React12.createElement(Gift, {\n      className: mx7(getSize3(5), \"inline mr-1\"),\n      weight: \"duotone\"\n    }), /* @__PURE__ */React12.createElement(\"span\", null, t(\"need refresh label\"))) : t(\"offline ready label\", {\n      appName: t(\"current app name\", {\n        ns: appNs\n      })\n    })\n  }, isNeedRefreshToast(props) && {\n    duration: 24e4,\n    description: t(\"need refresh description\"),\n    actionTriggers: [{\n      altText: t(\"refresh alt\"),\n      trigger: /* @__PURE__ */React12.createElement(Button4, {\n        variant: \"primary\",\n        onClick: () => props.updateServiceWorker()\n      }, t(\"refresh label\"))\n    }]\n  }, variant === \"offlineReady\" && {\n    closeTrigger: /* @__PURE__ */React12.createElement(Button4, null, t(\"confirm label\", {\n      ns: \"uikit\"\n    }))\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/components/SpaceList/SpaceList.tsx\nimport React13 from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Avatar as Avatar3, defaultGroup as defaultGroup3, defaultHover, defaultFocus as defaultFocus2, useTranslation as useTranslation10, defaultDisabled as defaultDisabled3, Group as Group3, Heading as Heading3, mx as mx8 } from \"@dxos/react-uikit\";\nimport { humanize as humanize3 } from \"@dxos/util\";\nvar SpaceList = ({\n  spaces = []\n}) => {\n  const {\n    t\n  } = useTranslation10(\"appkit\");\n  return spaces.length ? /* @__PURE__ */React13.createElement(React13.Fragment, null, spaces.map(space => {\n    var _a2;\n    const keyHex = space.key.toHex();\n    const title = (_a2 = space.properties.get(\"title\")) != null ? _a2 : humanize3(keyHex);\n    return /* @__PURE__ */React13.createElement(Link, {\n      to: `/spaces/${keyHex}`,\n      role: \"group\",\n      key: keyHex,\n      className: mx8(defaultGroup3({\n        elevation: 1,\n        rounding: \"rounded\",\n        spacing: \"p-2\"\n      }), \"flex items-stretch gap-2 mbe-2\", defaultHover({}), defaultFocus2)\n    }, /* @__PURE__ */React13.createElement(Heading3, {\n      level: 2,\n      className: \"grow flex items-center mbe-0\"\n    }, /* @__PURE__ */React13.createElement(Avatar3, {\n      size: 12,\n      fallbackValue: keyHex,\n      label: /* @__PURE__ */React13.createElement(\"p\", {\n        className: \"text-lg grow\"\n      }, title),\n      slots: {\n        root: {\n          className: \"flex gap-1 items-center pr-2 rounded\"\n        }\n      }\n    })));\n  })) : /* @__PURE__ */React13.createElement(Group3, {\n    className: \"mlb-4\",\n    label: {\n      level: 2,\n      children: t(\"empty spaces label\"),\n      className: mx8(\"text-xl\", defaultDisabled3)\n    },\n    elevation: 0\n  }, /* @__PURE__ */React13.createElement(\"p\", {\n    className: defaultDisabled3\n  }, t(\"empty spaces message\")));\n};\n\n// packages/apps/patterns/react-appkit/src/components/SpacesPage/SpacesPage.tsx\nimport { Plus, Rocket } from \"phosphor-react\";\nimport React14, { useCallback as useCallback6 } from \"react\";\nimport { generatePath as generatePath2, useNavigate as useNavigate3, useSearchParams } from \"react-router-dom\";\nimport { useClient as useClient3, useSpaces } from \"@dxos/react-client\";\nimport { Button as Button5, getSize as getSize4, JoinDialog, useTranslation as useTranslation11 } from \"@dxos/react-uikit\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar invitationCodeFromUrl = text => {\n  try {\n    const searchParams = new URLSearchParams(text.substring(text.lastIndexOf(\"?\")));\n    const invitation = searchParams.get(\"invitation\");\n    return invitation != null ? invitation : text;\n  } catch (err) {\n    console.error(err);\n    return text;\n  }\n};\nvar SpacesPage = ({\n  onSpaceCreate,\n  spacePath = \"/spaces/:space\"\n}) => {\n  const {\n    t\n  } = useTranslation11(\"appkit\");\n  const client = useClient3();\n  const spaces = useSpaces();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate3();\n  const invitationParam = searchParams.get(\"invitation\");\n  const acceptInvitation = useCallback6(invitation => client.echo.acceptInvitation(invitation), [client]);\n  const handleCreateSpace = useCallback6(async () => {\n    const space = await client.echo.createSpace();\n    await (onSpaceCreate == null ? void 0 : onSpaceCreate(space));\n  }, [client]);\n  const handleJoin = useCallback6(({\n    spaceKey\n  }) => navigate(generatePath2(spacePath, {\n    space: spaceKey.toHex()\n  })), [spacePath]);\n  return /* @__PURE__ */React14.createElement(React14.Fragment, null, /* @__PURE__ */React14.createElement(HeadingWithActions, {\n    className: \"flex-auto text-center mbe-4\",\n    actions: /* @__PURE__ */React14.createElement(React14.Fragment, null, /* @__PURE__ */React14.createElement(JoinDialog, {\n      initialInvitationCode: invitationParam != null ? invitationParam : void 0,\n      parseInvitation: invitationCode => invitationCodeFromUrl(invitationCode),\n      onJoin: handleJoin,\n      acceptInvitation,\n      dialogProps: {\n        initiallyOpen: Boolean(invitationParam),\n        openTrigger: /* @__PURE__ */React14.createElement(Button5, {\n          className: \"grow flex gap-1\"\n        }, /* @__PURE__ */React14.createElement(Rocket, {\n          className: getSize4(5)\n        }), t(\"join space label\", {\n          ns: \"uikit\"\n        }))\n      }\n    }), /* @__PURE__ */React14.createElement(Button5, {\n      variant: \"primary\",\n      onClick: handleCreateSpace,\n      className: \"grow flex gap-1\"\n    }, /* @__PURE__ */React14.createElement(Plus, {\n      className: getSize4(5)\n    }), t(\"create space label\", {\n      ns: \"uikit\"\n    }))),\n    heading: {\n      children: t(\"spaces label\")\n    }\n  }), /* @__PURE__ */React14.createElement(SpaceList, {\n    spaces\n  }));\n};\n\n// packages/apps/patterns/react-appkit/src/translations/en-US.ts\nvar en_US_exports = {};\n__export(en_US_exports, {\n  appkit: () => appkit\n});\nvar appkit = {\n  \"list title label\": \"List title\",\n  \"list title placeholder\": \"Untitled list\",\n  \"list description label\": \"List description\",\n  \"list description placeholder\": \"Add an optional description\",\n  \"list item title label\": \"List item title\",\n  \"list item title placeholder\": \"Type here\",\n  \"list item description label\": \"List item description\",\n  \"list item description placeholder\": \"Add an optional description\",\n  \"move list item up label\": \"Move list item up\",\n  \"move list item down label\": \"Move list item down\",\n  \"delete list item label\": \"Remove list item\",\n  \"add list item label\": \"Add list item\",\n  \"need refresh label\": \"Refresh now to get app updates\",\n  \"need refresh description\": \"You\\u2019ll need these updates to continue without interruption.\",\n  \"refresh label\": \"Refresh\",\n  \"refresh alt\": \"Click your browser\\u2019s refresh button or use the refresh keyboard shortcut.\",\n  \"offline ready label\": \"{appName} is ready to use offline.\",\n  \"spaces label\": \"Spaces\",\n  \"empty invitations message\": \"No pending invitations\",\n  \"invitations label\": \"Invitations\",\n  \"create invitation label\": \"Invite\",\n  \"current identity label\": \"You\",\n  \"empty members message\": \"No members in this space\",\n  \"composer placeholder\": \"Write something\\u2026\",\n  \"heartbeat stalled\": \"Heartbeat stalled\",\n  \"empty spaces label\": \"No spaces here\",\n  \"empty spaces message\": \"Why not try creating or joining one?\"\n};\n\n// packages/apps/patterns/react-appkit/src/translations/index.ts\nvar translations = {\n  \"en-US\": en_US_exports\n};\nexport { AppLayout, BASE_TELEMETRY_PROPERTIES, DX_ENVIRONMENT, DX_GROUP, DX_RELEASE, DX_TELEMETRY, ErrorContext, ErrorProvider, Fallback, FatalError, GenericFallback, HeadingWithActions, InvitationList, ManageSpacePage, ProfileList, RequireIdentity, ServiceWorkerToast, SpaceList, SpacesPage, StatusIndicator, getTelemetryIdentifier, setupTelemetryListeners, translations, useErrors, useSafeSpaceKey, useTelemetry };","start":1670465438856,"end":1670465438866,"order":"normal"}]}
