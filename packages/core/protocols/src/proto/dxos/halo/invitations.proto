//
// Copyright 2021 DXOS.org
//

syntax = "proto3";

import "google/protobuf/empty.proto";

import "dxos/keys.proto";

package dxos.halo.invitations;

message AuthenticationRequest {
  string authentication_code = 1;
}

//
// HALO device invitations.
//

message HaloAdmissionOffer {
  dxos.keys.PublicKey identity_key = 1;
  dxos.keys.PublicKey halo_space_key = 2;
  dxos.keys.PublicKey genesis_feed_key = 3;
}

message HaloAdmissionCredentials {
  dxos.keys.PublicKey device_key = 1;
  dxos.keys.PublicKey control_feed_key = 2;
  dxos.keys.PublicKey data_feed_key = 3;
}

service HaloHostService {
  /// Process admission offer from host.
  rpc RequestAdmission(google.protobuf.Empty) returns (HaloAdmissionOffer);

  /// Authenticate request.
  rpc Authenticate(AuthenticationRequest) returns (google.protobuf.Empty);

  /// Process admission request from guest.
  rpc PresentAdmissionCredentials(HaloAdmissionCredentials) returns (google.protobuf.Empty);
}

//
// Space agent invitations.
//

message SpaceAdmissionOffer {
  dxos.keys.PublicKey space_key = 1;
  dxos.keys.PublicKey genesis_feed_key = 3;
}

message SpaceAdmissionCredentials {
  dxos.keys.PublicKey identity_key = 1;
  dxos.keys.PublicKey device_key = 2;
  dxos.keys.PublicKey control_feed_key = 3;
  dxos.keys.PublicKey data_feed_key = 4;
}

message AdmissionParameters {
  /// Guest's profile.
  optional ProfileDocument profile = 1;
}

service SpaceHostService {
  /// Process admission request.
  rpc RequestAdmission(AdmissionParameters) returns (SpaceAdmissionOffer);

  /// Authenticate request.
  rpc Authenticate(AuthenticationRequest) returns (google.protobuf.Empty);

  /// Process admission credentials.
  rpc PresentAdmissionCredentials(SpaceAdmissionCredentials) returns (google.protobuf.Empty);
}
