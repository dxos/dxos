//
// Copyright 2021 DXOS.org
//

syntax = "proto3";

package dxos.registry;

import "google/protobuf/timestamp.proto";

message Record {
  message Type {
    string message_name = 1;                      // FQ protobuf message name.
    string protobuf_defs = 2;                     // Set of protobuf messages encoded in JSON.
    string protobuf_file = 3;                     // CID of protobuf source file.
  }

  message Extension {
    bytes type_record = 1;                        // CID of type record.
    bytes data = 2;                               // Serialized payload data.
  }

  //
  // Metadata
  //

  // Record creation timetstamp.
  google.protobuf.Timestamp created = 1;

  // Optional **semver 2.0** compliant record version.
  // Should conform to the semver regex (see https://semver.org/).
  string version = 2;

  // DEPREACATED
  string name = 3;                                // TODO(damaretskyi): Remove name.

  // Optional record description.
  string description = 4;

  // DEPREACATED
  string author = 5;                              // TODO(damaretskyi): Remove author. Infer it from the tx that registered this record.
  
  oneof kind {
    Type type = 100;
    Extension payload = 101;

    // TODO(damaretskyi): Add DID record definition.
  }
}
