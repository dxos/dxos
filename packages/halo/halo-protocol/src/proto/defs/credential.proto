//
// Copyright 2020 DXOS.org
//

syntax = "proto3";

package dxos.halo.credentials;

//
// Verificable crednetials based loosely on the W3C spec.
// https://www.w3.org/TR/vc-data-model
//

// TODO(burdon): Type subject/identifiers (e.g., did string, public key, etc.)

//
// One or more cryptographic proofs that can be used to detect tampering and verify the authorship of a credential or presentation.
// https://www.w3.org/TR/vc-data-model/#proofs-signatures
// https://www.w3.org/TR/vc-data-model/#json-web-token
// https://datatracker.ietf.org/doc/html/rfc7515 (JWS)
//
message Proof {
  string type = 1;
  string created = 2;
  string jws = 3;
}

//
// A credential is a set of one or more claims made by the same entity (issuer).
// https://www.w3.org/TR/vc-data-model/#credentials
//
message Credential {
  //
  // A claim is a statement about a subject.
  // https://www.w3.org/TR/vc-data-model/#credential-subject
  //
  message CredentialSubject {
    string id = 1;
    string property = 2;
    string value = 3; // TODO(burdon): google.protobuf.Struct
  }

  string id = 1;
  optional string type = 2;
  optional string issuer = 3;
  optional string issuanceDate = 4;
  optional string validUntil = 5;
  repeated CredentialSubject credentialSubject = 6;
  repeated Proof proof = 7;
}

//
// A verifiable presentation expresses data from one or more verifiable credentials,
// and is packaged in such a way that the authorship of the data is verifiable.
// https://www.w3.org/TR/vc-data-model/#presentations
//
message Presentation {
  string id = 1;
  string type = 2;
  repeated Credential credential = 3;
  repeated Proof proof = 4;
}
